(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07bfe8d0"],{bd56:function(t,e,o){"use strict";var s=o("f245"),i=o.n(s);i.a},ce01:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.isLoadingScreens?o("div",{staticClass:"full-page-flex"},[o("div",{staticClass:"flex-fill-block"}),t._m(0),o("div",{staticClass:"flex-fill-block"})]):t.activeScreen?o("div",{staticClass:"preview-container",class:{"comments-mode":t.isInCommentsMode,"hotspots-mode":t.isInHotspotsMode,"preview-mode":t.isInPreviewMode,"preview-mode-hints":t.isPreviewModeHintsActive},style:{background:t.activePrototype.isForDesktop&&t.activeScreen?t.activeScreen.background:null},attrs:{tabindex:"-1"},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.onEscPress(e)},function(t){return(t.type.indexOf("key")||83===t.keyCode)&&t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:void t.preventDefault():null}],keyup:function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.snapActiveHotspot(e)):null}}},[o("div",{staticClass:"flex-fill-block"}),o("hotspot-popover",{ref:"hotspotPopover",on:{closed:t.onHotspotPopoverClose}}),o("comment-popover",{ref:"commentPopover",attrs:{isForPreview:!1,mentionsList:t.mentionsList},on:{closed:t.onCommentPopoverClose}}),o("screen-preview",{ref:"screenPreview",attrs:{interactions:t.isInPreviewMode,activeScreenTooltip:t.modeHelpTooltip},on:{activeScreenMousedown:t.onActiveScreenMousedown,activeScreenClick:t.onActiveScreenClick}},[t.isInHotspotsMode?o("div",{staticClass:"block hotspots-block"},t._l(t.activeScreenHotspots,function(e){return o("hotspot-box",{key:e.id,ref:"hotspotBoxes",refInFor:!0,attrs:{hotspot:e,snapToImage:t.$refs.screenPreview?t.$refs.screenPreview.$refs.activeScreen:null},on:{repositioning:t.onHotspotRepositioning,repositionStopped:t.onHotspotRepositioning,beforeActivate:t.onHotspotActivate}})}),1):t._e(),t.isInCommentsMode?o("div",{staticClass:"block comments-block"},t._l(t.activeScreenComments,function(e){return o("comment-pin",{key:e.id,ref:"screenCommentPins",refInFor:!0,class:{"soft-hidden":!t.showResolvedComments&&e.isResolved,unread:t.isCommentUnread(e.id)},attrs:{comment:e,allowPositionChange:!0},on:{repositioning:t.onCommentRepositioning,beforeActivate:t.onCommentActivate}})}),1):t._e()]),o("div",{staticClass:"flex-fill-block"}),o("nav",{staticClass:"floating-bar preview-bar active"},[o("div",{staticClass:"nav nav-left"},[o("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Back to listing"),expression:"$t('Back to listing')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-close",attrs:{to:{name:"prototype",params:{projectId:t.activePrototype.projectId,prototypeId:t.activePrototype.id}}}},[o("i",{staticClass:"fe fe-arrow-left"})]),t.$refs.screensPanel?o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t(t.$refs.screensPanel.isActive?"Hide screens panel":"Show screens panel"),expression:"$t($refs.screensPanel.isActive ? 'Hide screens panel' : 'Show screens panel')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-screens",class:{active:t.$refs.screensPanel.isActive},on:{click:function(e){return e.preventDefault(),t.$refs.screensPanel.toggle()}}},[o("span",{staticClass:"txt screen-title"},[t._v(t._s(t.activeScreen.title))]),o("span",{staticClass:"txt counter m-l-5"},[t._v("("+t._s(t.$t("{current} of {total}",{current:t.activeScreenOrderedIndex+1,total:t.screens.length}))+")")]),o("i",{staticClass:"m-l-5 fe",class:t.$refs.screensPanel.isActive?"fe-chevron-up":"fe-chevron-down"})]):t._e()],1),o("div",{staticClass:"nav nav-center"},[o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Preview mode (P)"),expression:"$t('Preview mode (P)')",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.80",value:t.setPreviewMode,expression:"setPreviewMode",modifiers:{80:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-success",class:{highlight:t.isInPreviewMode},on:{click:function(e){return e.preventDefault(),t.setPreviewMode()}}},[o("i",{staticClass:"fe fe-eye"})]),o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Hotspots mode (H)"),expression:"$t('Hotspots mode (H)')",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.72",value:t.setHotspotsMode,expression:"setHotspotsMode",modifiers:{72:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-primary",class:{highlight:t.isInHotspotsMode},on:{click:function(e){return e.preventDefault(),t.setHotspotsMode()}}},[t.isLoadingHotspots||t.isLoadingHotspotTemplates?o("span",{staticClass:"loader"}):o("i",{staticClass:"fe fe-target"})]),o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Comments mode (C)"),expression:"$t('Comments mode (C)')",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.67",value:t.setCommentsMode,expression:"setCommentsMode",modifiers:{67:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-danger",class:{highlight:t.isInCommentsMode},on:{click:function(e){return e.preventDefault(),t.setCommentsMode()}}},[t.activeUnreadComments.length?o("span",{staticClass:"beacon beacon-danger"}):t._e(),t.isLoadingComments?o("span",{staticClass:"loader"}):o("i",{staticClass:"fe fe-message-circle"})])]),o("div",{staticClass:"nav nav-right"},[t.isInCommentsMode&&t.totalActiveScreenComments>0?o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.showResolvedComments,expression:"showResolvedComments"}],attrs:{type:"checkbox",id:"toggle_resolved_comments"},domProps:{checked:Array.isArray(t.showResolvedComments)?t._i(t.showResolvedComments,null)>-1:t.showResolvedComments},on:{change:function(e){var o=t.showResolvedComments,s=e.target,i=!!s.checked;if(Array.isArray(o)){var n=null,r=t._i(o,n);s.checked?r<0&&(t.showResolvedComments=o.concat([n])):r>-1&&(t.showResolvedComments=o.slice(0,r).concat(o.slice(r+1)))}else t.showResolvedComments=i}}}),o("label",{attrs:{for:"toggle_resolved_comments"}},[t._v("\n                    "+t._s(t.$t("Show resolved comments"))+"\n                    ("+t._s(t.$t("{current} of {total}",{current:t.totalActiveScreenResolvedComments,total:t.totalActiveScreenComments}))+")\n                ")])]):t._e(),t.isInHotspotsMode?o("div",{staticClass:"ctrl-item ctrl-item-templates txt-default"},[o("span",{staticClass:"txt counter m-r-5"},[t._v(t._s(t.totalActiveHotspotTemplates))]),o("span",{staticClass:"txt title m-r-5"},[t._v("\n                    "+t._s(t.$t(1==t.totalActiveHotspotTemplates?t.$t("Active hotspot template"):t.$t("Active hotspot templates")))+"\n                ")]),o("i",{staticClass:"fe fe-chevron-up"}),o("hotspot-templates-popover",{staticClass:"transform-bottom-right",attrs:{screen:t.activeScreen}})],1):t._e(),o("div",{staticClass:"ctrl-item ctrl-item-circle"},[o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Screen settings"),expression:"$t('Screen settings')",modifiers:{top:!0}}]},[o("i",{staticClass:"fe fe-settings"})]),o("screen-edit-popover",{ref:"screenEditPopover",staticClass:"transform-bottom-right",attrs:{screen:t.activeScreen}})],1)])]),o("screens-panel",{ref:"screensPanel"})],1):t._e()},i=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"block txt-center"},[o("span",{staticClass:"loader loader-lg loader-blend"})])}],n=(o("8e6e"),o("ac6a"),o("456d"),o("7f7f"),o("a481"),o("bd86")),r=o("2f62"),a=o("f744"),l=o("dd93"),c=o("0372"),p=o("9aaf"),d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("toggler",{ref:"popover",staticClass:"popover",attrs:{tag:"form",hideOnChildClick:!1},nativeOn:{submit:function(e){return e.preventDefault(),t.submitForm()}}},[o("form-field",{attrs:{name:"title"}},[o("label",{attrs:{for:"screen_title"}},[t._v(t._s(t.$t("Title")))]),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.title,expression:"title",modifiers:{trim:!0}}],attrs:{type:"text",id:"screen_title"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-6"},[o("div",{staticClass:"form-group form-group"},[o("label",{attrs:{for:"screen_alignment"}},[t._v(t._s(t.$t("Alignment")))]),o("div",{staticClass:"switch-group"},[o("div",{staticClass:"switch"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.alignment,expression:"alignment"}],attrs:{type:"radio",value:"left",id:"screen_alignment_radio_left"},domProps:{checked:t._q(t.alignment,"left")},on:{change:function(e){t.alignment="left"}}}),o("label",{attrs:{for:"screen_alignment_radio_left"}},[t._v(t._s(t.$t("Left")))])]),o("div",{staticClass:"switch"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.alignment,expression:"alignment"}],attrs:{type:"radio",value:"center",id:"screen_alignment_radio_center"},domProps:{checked:t._q(t.alignment,"center")},on:{change:function(e){t.alignment="center"}}}),o("label",{attrs:{for:"screen_alignment_radio_center"}},[t._v(t._s(t.$t("Center")))])]),o("div",{staticClass:"switch"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.alignment,expression:"alignment"}],attrs:{type:"radio",value:"right",id:"screen_alignment_radio_right"},domProps:{checked:t._q(t.alignment,"right")},on:{change:function(e){t.alignment="right"}}}),o("label",{attrs:{for:"screen_alignment_radio_right"}},[t._v(t._s(t.$t("Right")))])])])])]),o("div",{staticClass:"col-6"},[o("form-field",{attrs:{name:"background"}},[o("label",{attrs:{for:"screen_background"}},[t._v(t._s(t.$t("Background")))]),o("div",{staticClass:"input-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.background,expression:"background"}],attrs:{type:"color",id:"screen_background"},domProps:{value:t.background},on:{input:function(e){e.target.composing||(t.background=e.target.value)}}}),o("label",{staticClass:"input-addon txt-monospace p-l-0",attrs:{for:"screen_background"}},[t._v(t._s(t.background))])])])],1)]),o("div",{staticClass:"row align-items-center"},[o("div",{staticClass:"col-6"},[o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.hasFixedHeader,expression:"hasFixedHeader"}],attrs:{type:"checkbox",id:"screen_fixed_header_check"},domProps:{checked:Array.isArray(t.hasFixedHeader)?t._i(t.hasFixedHeader,null)>-1:t.hasFixedHeader},on:{change:function(e){var o=t.hasFixedHeader,s=e.target,i=!!s.checked;if(Array.isArray(o)){var n=null,r=t._i(o,n);s.checked?r<0&&(t.hasFixedHeader=o.concat([n])):r>-1&&(t.hasFixedHeader=o.slice(0,r).concat(o.slice(r+1)))}else t.hasFixedHeader=i}}}),o("label",{attrs:{for:"screen_fixed_header_check"}},[t._v(t._s(t.$t("Has fixed header")))])])]),o("div",{staticClass:"col-6"},[o("form-field",{directives:[{name:"show",rawName:"v-show",value:t.hasFixedHeader,expression:"hasFixedHeader"}],staticClass:"form-group-sm",attrs:{name:"fixedHeader"}},[o("div",{staticClass:"input-group"},[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.fixedHeader,expression:"fixedHeader",modifiers:{number:!0}}],attrs:{type:"number",min:"0"},domProps:{value:t.fixedHeader},on:{input:function(e){e.target.composing||(t.fixedHeader=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon"},[t._v("px")])])])],1)]),o("div",{staticClass:"row align-items-center"},[o("div",{staticClass:"col-6"},[o("div",{staticClass:"form-group m-b-0"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.hasFixedFooter,expression:"hasFixedFooter"}],attrs:{type:"checkbox",id:"screen_fixed_footer_check"},domProps:{checked:Array.isArray(t.hasFixedFooter)?t._i(t.hasFixedFooter,null)>-1:t.hasFixedFooter},on:{change:function(e){var o=t.hasFixedFooter,s=e.target,i=!!s.checked;if(Array.isArray(o)){var n=null,r=t._i(o,n);s.checked?r<0&&(t.hasFixedFooter=o.concat([n])):r>-1&&(t.hasFixedFooter=o.slice(0,r).concat(o.slice(r+1)))}else t.hasFixedFooter=i}}}),o("label",{attrs:{for:"screen_fixed_footer_check"}},[t._v(t._s(t.$t("Has fixed footer")))])])]),o("div",{staticClass:"col-6"},[o("form-field",{directives:[{name:"show",rawName:"v-show",value:t.hasFixedFooter,expression:"hasFixedFooter"}],staticClass:"m-b-0 form-group-sm",attrs:{name:"fixedFooter"}},[o("div",{staticClass:"input-group"},[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.fixedFooter,expression:"fixedFooter",modifiers:{number:!0}}],attrs:{type:"number",min:"0"},domProps:{value:t.fixedFooter},on:{input:function(e){e.target.composing||(t.fixedFooter=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon"},[t._v("px")])])])],1)]),o("hr",{staticClass:"m-t-20 m-b-20"}),o("div",{staticClass:"flex-block"},[o("button",{staticClass:"btn btn-light-border",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.$refs.popover.hide()}}},[o("span",{staticClass:"txt"},[t._v(t._s(t.$t("Cancel")))])]),o("div",{staticClass:"flex-fill-block"}),o("button",{staticClass:"btn btn-primary btn-cons btn-loader",class:{"btn-loader-active":t.isProcessing},attrs:{type:"submit"}},[o("span",{staticClass:"txt"},[t._v(t._s(t.$t("Save changes")))])])])],1)},h=[],u=o("2714");function m(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,s)}return o}function f(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?m(o,!0).forEach(function(e){Object(n["a"])(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):m(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var v={title:"",background:"#ffffff",alignment:"center",fixedHeader:0,fixedFooter:0,hasFixedHeader:!1,hasFixedFooter:!1},g={name:"screen-edit-popover",props:{screen:{type:u["a"],required:!0}},data:function(){return{isProcessing:!1,title:v.title,background:v.background,alignment:v.alignment,fixedHeader:v.fixedHeader,fixedFooter:v.fixedFooter,hasFixedHeader:v.hasFixedHeader,hasFixedFooter:v.hasFixedFooter}},watch:{screen:function(t,e){this.loadForm(t)}},mounted:function(){this.loadForm()},methods:f({},Object(r["b"])({setErrors:"form-field/setErrors"}),{loadForm:function(t){t=t||this.screen||{},this.title=t.title||v.title,this.background=t.background||v.background,this.alignment=t.alignment||v.alignment,this.fixedHeader=t.fixedHeader||v.fixedHeader,this.fixedFooter=t.fixedFooter||v.fixedFooter,this.hasFixedHeader=!!t.fixedHeader,this.hasFixedFooter=!!t.fixedFooter,this.setErrors({})},submitForm:function(){var t=this;this.isProcessing||(this.isProcessing=!0,a["a"].Screens.update(this.screen.id,{title:this.title,background:this.background,alignment:this.alignment,fixedHeader:this.hasFixedHeader?this.fixedHeader:0,fixedFooter:this.hasFixedFooter?this.fixedFooter:0}).then(function(e){t.screen.load(e.data),t.loadForm(),t.$toast(t.$t('Successfully updated screen "{title}".',{title:t.screen.title})),t.$refs.popover&&t.$refs.popover.hide(),t.$emit("updated",t.screen.id)}).catch(function(e){t.$errResponseHandler(e)}).finally(function(){t.isProcessing=!1}))}})},b=g,y=o("2877"),_=Object(y["a"])(b,d,h,!1,null,null,null),w=_.exports,C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("dragger",{staticClass:"hotspot",class:{new:!t.hotspot.id,highlight:t.hotspot.hotspotTemplateId>0,active:t.isActive},style:{left:t.hotspot.left*t.scaleFactor+"px",top:t.hotspot.top*t.scaleFactor+"px",width:t.hotspot.width*t.scaleFactor+"px",height:t.hotspot.height*t.scaleFactor+"px"},attrs:{wrapperSelector:".screen-inner-wrapper"},on:{dragging:t.onRepositioning,dragStarted:t.onRepositionStart,dragStopped:t.onRepositionStop},nativeOn:{click:function(e){return e.preventDefault(),t.activate()}}},[o("resizer",{ref:"resizeHandle",staticClass:"resize-handle",attrs:{wrapperSelector:".screen-inner-wrapper",containerSelector:".hotspot",tolerance:0},on:{resizing:t.onRepositioning,resizeStarted:t.onRepositionStart,resizeStopped:t.onRepositionStop}})],1)},$=[],x=o("82bb"),k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:t.dragInit(e)},touchstart:t.dragInit}},[t._t("default")],2)},H=[],T=(o("c5f6"),{name:"resizer",props:{containerSelector:{type:String},wrapperSelector:{type:String},tolerance:{type:Number,default:5}},data:function(){return{resizeStarted:!1,lockX:!1,lockY:!1,startX:0,startY:0,initialContainerX:0,initialContainerY:0,initialContainerWidth:0,initialContainerHeight:0,initialWrapperWidth:0,initialWrapperHeight:0}},computed:{container:function(){return this.$el.closest(this.containerSelector)||this.$el.parentNode},wrapper:function(){return this.container.closest(this.wrapperSelector)||this.container.parentNode}},methods:{dragInit:function(t){t.stopPropagation(),this.startX=t.clientX,this.startY=t.clientY,this.initialContainerX=this.container.offsetLeft,this.initialContainerY=this.container.offsetTop,this.initialContainerWidth=this.container.offsetWidth,this.initialContainerHeight=this.container.offsetHeight,this.initialWrapperWidth=this.wrapper.scrollWidth||this.wrapper.offsetWidth,this.initialWrapperHeight=this.wrapper.scrollHeight||this.wrapper.offsetHeight,document.addEventListener("touchmove",this.onMove),document.addEventListener("mousemove",this.onMove),document.addEventListener("touchend",this.onDrop),document.addEventListener("mouseup",this.onDrop)},onMove:function(t){var e=t.clientX-this.startX,o=t.clientY-this.startY,s=null,i=null,n=null,r=null;!this.resizeStarted&&Math.abs(e)<this.tolerance&&Math.abs(o)<this.tolerance||(t.preventDefault(),this.resizeStarted||(this.resizeStarted=!0,this.container.classList.add("no-pointer-events"),this.wrapper.classList.add("resizing"),document.body.classList.add("resizer-active"),this.$emit("resizeStarted",t)),this.$emit("resizing",t),t.shiftKey?this.lockX||this.lockY||(Math.abs(e)>Math.abs(o)?(this.lockX=!1,this.lockY=!0):(this.lockX=!0,this.lockY=!1)):(this.lockX=!1,this.lockY=!1),this.lockX||(e<0&&e<-this.initialContainerWidth?(n=-(this.initialContainerWidth+e),s=this.initialContainerX-n,s<0&&(s=null,n=null)):(n=this.initialContainerWidth+e,n+this.initialContainerX>this.initialWrapperWidth&&(n=null,s=null))),this.lockY||(o<0&&o<-this.initialContainerHeight?(r=-(this.initialContainerHeight+o),i=this.initialContainerY-r,i<0&&(i=null,r=null)):(r=this.initialContainerHeight+o,r+this.initialContainerY>this.initialWrapperHeight&&(r=null,i=null))),null!==s&&(this.container.style.left=s+"px"),null!==n&&(this.container.style.width=n+"px"),null!==i&&(this.container.style.top=i+"px"),null!==r&&(this.container.style.height=r+"px"))},onDrop:function(t){this.resizeStarted&&(t.preventDefault(),this.resizeStarted=!1,this.lockX=!1,this.lockY=!1,this.container.classList.remove("no-pointer-events"),this.wrapper.classList.remove("resizing"),document.body.classList.remove("resizer-active"),this.$emit("resizeStopped",t)),document.removeEventListener("touchmove",this.onMove),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("touchend",this.onDrop),document.removeEventListener("mouseup",this.onDrop)}}}),P=T,S=Object(y["a"])(P,k,H,!1,null,null,null),O=S.exports,I=o("49cb");function j(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,s)}return o}function F(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?j(o,!0).forEach(function(e){Object(n["a"])(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):j(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var A={name:"hotspot-box",components:{dragger:x["a"],resizer:O},props:{hotspot:{type:I["a"],required:!0},snapToImage:{}},data:function(){return{isActive:!1}},computed:F({},Object(r["d"])({scaleFactor:function(t){return t.screens.scaleFactor}})),methods:{activate:function(){this.isActive||(this.$emit("beforeActivate",this.hotspot,this.$el),this.isActive=!0,this.positionWithinView(),this.$emit("activated",this.hotspot,this.$el))},deactivate:function(){this.isActive&&(this.$emit("beforeDeactivate",this.hotspot,this.$el),this.isActive=!1,this.hotspot.id||this.$emit("hotspotDeleted",this.hotspot,this.$el),this.$emit("deactivated",this.hotspot,this.$el))},positionWithinView:function(){this.$el.scrollIntoView({behavior:"smooth",block:"nearest"})},initResizing:function(t){this.$refs.resizeHandle.dragInit(t),this.$refs.resizeHandle.onMove(t)},onRepositionStart:function(t){this.$emit("repositionStarted",this.hotspot,this.$el)},onRepositioning:function(t){this.$emit("repositioning",this.hotspot,this.$el)},onRepositionStop:function(t){var e=this;this.$set(this.hotspot,"left",Math.max(this.$el.offsetLeft,0)/this.scaleFactor),this.$set(this.hotspot,"top",Math.max(this.$el.offsetTop,0)/this.scaleFactor),this.$set(this.hotspot,"width",this.$el.offsetWidth/this.scaleFactor),this.$set(this.hotspot,"height",this.$el.offsetHeight/this.scaleFactor),t.ctrlKey?this.$nextTick(function(){e.snap()}):this.savePosition(),this.$emit("repositionStopped",this.hotspot,this.$el)},snap:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.snapToImage){var e=l["a"].closestFeatureEdge(this.snapToImage,{x:this.hotspot.left,y:this.hotspot.top,w:this.hotspot.width,h:this.hotspot.height});this.$set(this.hotspot,"left",e.x+this.hotspot.left),this.$set(this.hotspot,"top",e.y+this.hotspot.top),this.$set(this.hotspot,"width",e.w),this.$set(this.hotspot,"height",e.h),this.$emit("repositionStopped",this.hotspot,this.$el)}t&&this.savePosition()},savePosition:function(){var t=this;this.hotspot.id&&(this.$emit("hotspotUpdated",this.hotspot,this.$el),a["a"].Hotspots.update(this.hotspot.id,{width:this.hotspot.width,height:this.hotspot.height,left:this.hotspot.left,top:this.hotspot.top}).then(function(e){t.hotspot.load(e.data)}))}}},D=A,N=Object(y["a"])(D,C,$,!1,null,null,null),L=N.exports,M=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"popover-holder hotspot-popover-holder"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"popover-overlay",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.close()}}}),o("div",{ref:"popover",staticClass:"popover hotspot-popover",class:{active:t.isActive}},[o("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm()}}},[o("form-field",{attrs:{name:"type"}},[o("div",{staticClass:"input-group"},[o("label",{staticClass:"input-addon bg-border txt-default"},[t._v(t._s(t.$t("Link to")))]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],attrs:{id:"hotspot_type_"+t.hotspot.id,required:""},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.type=e.target.multiple?o:o[0]}}},[o("option",{attrs:{value:"screen"}},[t._v(t._s(t.$t("Screen")))]),o("option",{attrs:{value:"overlay"}},[t._v(t._s(t.$t("Screen as overlay")))]),o("option",{attrs:{value:"prev"}},[t._v(t._s(t.$t("Prev screen in series")))]),o("option",{attrs:{value:"next"}},[t._v(t._s(t.$t("Next screen in series")))]),o("option",{attrs:{value:"back"}},[t._v(t._s(t.$t("Back (last visited screen)")))]),o("option",{attrs:{value:"scroll"}},[t._v(t._s(t.$t("Position (scroll to)")))]),o("option",{attrs:{value:"url"}},[t._v(t._s(t.$t("External URL")))])])])]),o("form-field",{directives:[{name:"show",rawName:"v-show",value:"screen"===t.type||"overlay"===t.type,expression:"type === 'screen' || type === 'overlay'"}],attrs:{name:"settingScreenId"}},[o("label",[t._v(t._s(t.$t("Screen")))]),o("div",{staticClass:"btn btn-block btn-light-border btn-dropdown",attrs:{tabindex:"0"},on:{keydown:[function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"]))return null;e.preventDefault(),!t.$refs.screensDropdown||t.$refs.screensDropdown.show()},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault(),!t.$refs.screensDropdown||t.$refs.screensDropdown.toggle()}]}},[o("span",{staticClass:"txt"},[t._v(t._s(t.selectedScreen?t.selectedScreen.title:t.$t("Select a screen...")))]),o("toggler",{ref:"screensDropdown",staticClass:"dropdown dropdown-thumbs-list",on:{show:t.onScreensDropdownShow}},t._l(t.orderedScreens,function(e){return o("figure",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.title,expression:"screen.title",modifiers:{top:!0}}],key:"hotspot_screen_"+e.id,staticClass:"thumb thumb-handle",class:{active:e.id==t.screenId},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.selectScreen(e.id)}}},[e.getImage("small")?o("img",{staticClass:"img",attrs:{src:e.getImage("small"),alt:e.title}}):o("i",{staticClass:"fe fe-image img"})])}),0)],1)]),o("div",{staticClass:"row"},[o("div",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],staticClass:"col-6"},[o("form-field",{attrs:{name:"settingOverlayPosition"}},[o("label",{attrs:{for:"hotspot_screen_overlay_position_"+t.hotspot.id}},[t._v(t._s(t.$t("Position")))]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.overlayPosition,expression:"overlayPosition"}],attrs:{id:"hotspot_screen_overlay_position_"+t.hotspot.id},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.overlayPosition=e.target.multiple?o:o[0]}}},[o("option",{attrs:{value:"centered"}},[t._v(t._s(t.$t("Centered")))]),o("option",{attrs:{value:"top-left"}},[t._v(t._s(t.$t("Top Left")))]),o("option",{attrs:{value:"top-center"}},[t._v(t._s(t.$t("Top Center")))]),o("option",{attrs:{value:"top-right"}},[t._v(t._s(t.$t("Top Right")))]),o("option",{attrs:{value:"bottom-left"}},[t._v(t._s(t.$t("Bottom Left")))]),o("option",{attrs:{value:"bottom-center"}},[t._v(t._s(t.$t("Bottom Center")))]),o("option",{attrs:{value:"bottom-right"}},[t._v(t._s(t.$t("Bottom Right")))])])])],1),o("div",{directives:[{name:"show",rawName:"v-show",value:"url"!==t.type&&"scroll"!==t.type,expression:"type !== 'url' && type !== 'scroll'"}],class:"overlay"===t.type?"col-6":"col-12"},[o("form-field",{attrs:{name:"settingTransition"}},[o("label",{attrs:{for:"hotspot_transition_"+t.hotspot.id}},[t._v(t._s(t.$t("Transition")))]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.transition,expression:"transition"}],attrs:{id:"hotspot_transition_"+t.hotspot.id},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.transition=e.target.multiple?o:o[0]}}},[o("option",{attrs:{value:"none"}},[t._v(t._s(t.$t("None")))]),o("option",{attrs:{value:"fade"}},[t._v(t._s(t.$t("Fade")))]),o("option",{attrs:{value:"slide-left"}},[t._v(t._s(t.$t("Slide left")))]),o("option",{attrs:{value:"slide-right"}},[t._v(t._s(t.$t("Slide right")))]),o("option",{attrs:{value:"slide-top"}},[t._v(t._s(t.$t("Slide top")))]),o("option",{attrs:{value:"slide-bottom"}},[t._v(t._s(t.$t("Slide bottom")))])])])],1)]),o("div",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],staticClass:"form-group form-group-sm"},[o("label",{attrs:{for:""}},[t._v(t._s(t.$t("Offset"))+" "),o("small",{staticClass:"txt-hint"},[t._v("(px)")])]),o("div",{staticClass:"input-group"},[o("div",{staticClass:"input-addon bg-light-border"},[t._v("T")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetTop,expression:"offsetTop",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Top offset"),expression:"$t('Top offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetTop},on:{input:function(e){e.target.composing||(t.offsetTop=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon bg-light-border"},[t._v("B")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetBottom,expression:"offsetBottom",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Bottom offset"),expression:"$t('Bottom offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetBottom},on:{input:function(e){e.target.composing||(t.offsetBottom=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon bg-light-border"},[t._v("L")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetLeft,expression:"offsetLeft",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Left offset"),expression:"$t('Left offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetLeft},on:{input:function(e){e.target.composing||(t.offsetLeft=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon bg-light-border"},[t._v("R")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.offsetRight,expression:"offsetRight",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("Right offset"),expression:"$t('Right offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:t.offsetRight},on:{input:function(e){e.target.composing||(t.offsetRight=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),o("div",{directives:[{name:"show",rawName:"v-show",value:"scroll"===t.type,expression:"type === 'scroll'"}],staticClass:"row"},[o("div",{staticClass:"col-6"},[o("form-field",{attrs:{name:"settingScrollTop"}},[o("label",{attrs:{for:"hotspot_scroll_top_"+t.hotspot.id}},[t._v(t._s(t.$t("Vertical position")))]),o("div",{staticClass:"input-group"},[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.scrollTop,expression:"scrollTop",modifiers:{number:!0}}],attrs:{type:"number",id:"hotspot_scroll_top_"+t.hotspot.id,min:"0"},domProps:{value:t.scrollTop},on:{input:function(e){e.target.composing||(t.scrollTop=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon"},[t._v("px")])])])],1),o("div",{staticClass:"col-6"},[o("form-field",{attrs:{name:"settingScrollLeft"}},[o("label",{attrs:{for:"hotspot_scroll_left_"+t.hotspot.id}},[t._v(t._s(t.$t("Horizontal position")))]),o("div",{staticClass:"input-group"},[o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.scrollLeft,expression:"scrollLeft",modifiers:{number:!0}}],attrs:{type:"number",id:"hotspot_scroll_left_"+t.hotspot.id,min:"0"},domProps:{value:t.scrollLeft},on:{input:function(e){e.target.composing||(t.scrollLeft=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),o("div",{staticClass:"input-addon"},[t._v("px")])])])],1)]),o("form-field",{directives:[{name:"show",rawName:"v-show",value:"overlay"===t.type,expression:"type === 'overlay'"}],attrs:{name:"settingOutsideClose"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.outsideClose,expression:"outsideClose"}],attrs:{type:"checkbox",id:"hotspot_screen_overlay_outside_click_"+t.hotspot.id},domProps:{checked:Array.isArray(t.outsideClose)?t._i(t.outsideClose,null)>-1:t.outsideClose},on:{change:function(e){var o=t.outsideClose,s=e.target,i=!!s.checked;if(Array.isArray(o)){var n=null,r=t._i(o,n);s.checked?r<0&&(t.outsideClose=o.concat([n])):r>-1&&(t.outsideClose=o.slice(0,r).concat(o.slice(r+1)))}else t.outsideClose=i}}}),o("label",{attrs:{for:"hotspot_screen_overlay_outside_click_"+t.hotspot.id}},[t._v(t._s(t.$t("Close on outside click")))])]),o("form-field",{directives:[{name:"show",rawName:"v-show",value:"url"===t.type,expression:"type === 'url'"}],attrs:{name:"settingUrl"}},[o("label",{attrs:{for:"hotspot_external_url_"+t.hotspot.id}},[t._v("URL")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],attrs:{type:"url",id:"hotspot_external_url_"+t.hotspot.id,placeholder:t.$t("eg.")+" https://google.com"},domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}})]),o("div",{staticClass:"form-group m-b-10"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.includeInTemplate,expression:"includeInTemplate"}],attrs:{type:"checkbox",id:"hotspot_include_in_template_toggle_"+t.hotspot.id},domProps:{checked:Array.isArray(t.includeInTemplate)?t._i(t.includeInTemplate,null)>-1:t.includeInTemplate},on:{change:function(e){var o=t.includeInTemplate,s=e.target,i=!!s.checked;if(Array.isArray(o)){var n=null,r=t._i(o,n);s.checked?r<0&&(t.includeInTemplate=o.concat([n])):r>-1&&(t.includeInTemplate=o.slice(0,r).concat(o.slice(r+1)))}else t.includeInTemplate=i}}}),o("label",{attrs:{for:"hotspot_include_in_template_toggle_"+t.hotspot.id}},[t._v(t._s(t.$t("Include in template")))])]),o("div",{directives:[{name:"show",rawName:"v-show",value:t.includeInTemplate,expression:"includeInTemplate"}],staticClass:"form-group-section m-b-0"},[o("div",{staticClass:"form-group form-group-sm"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.template,expression:"template"}],on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.template=e.target.multiple?o:o[0]}}},[t._l(t.hotspotTemplates,function(e){return o("option",{domProps:{value:e.id}},[t._v("\n                            "+t._s(e.title)+"\n                        ")])}),o("option",{attrs:{value:"new"}},[t._v("+ "+t._s(t.$t("New template")))])],2)]),"new"===t.template?o("div",{staticClass:"form-group form-group-sm"},[o("div",{staticClass:"input-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newTemplateTitle,expression:"newTemplateTitle"}],attrs:{type:"text",placeholder:t.$t("Template name")+" *"},domProps:{value:t.newTemplateTitle},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.createHotspotTemplate())},input:function(e){e.target.composing||(t.newTemplateTitle=e.target.value)}}}),o("div",{staticClass:"input-addon link-primary bg-border",on:{click:function(e){return e.preventDefault(),t.createHotspotTemplate()}}},[t.isCreatingHotspotTemplate?o("span",{staticClass:"loader"}):o("span",{staticClass:"txt"},[t._v(t._s(t.$t("Save template")))])])])]):t._e()]),o("hr",{staticClass:"m-t-20 m-b-20"}),o("div",{staticClass:"flex-block"},[o("button",{staticClass:"btn btn-light-border",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.close()}}},[o("span",{staticClass:"txt"},[t._v(t._s(t.$t("Cancel")))])]),t.hotspot.id?o("span",{staticClass:"link-fade txt-danger m-l-small",on:{click:function(e){return e.preventDefault(),t.deleteHotspot()}}},[t._v("\n                    "+t._s(t.$t("Delete"))+"\n                ")]):t._e(),o("div",{staticClass:"flex-fill-block"}),o("button",{staticClass:"btn btn-primary btn-cons-sm btn-loader",class:{"btn-loader-active":t.isProcessing},attrs:{type:"submit"}},[o("span",{staticClass:"txt"},[t._v(t._s(t.hotspot.id?t.$t("Update"):t.$t("Create")))])])])],1)])])},R=[];function E(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,s)}return o}function B(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?E(o,!0).forEach(function(e){Object(n["a"])(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):E(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var z={name:"hotspot-popover",data:function(){return{isActive:!1,repositionToElem:null,hotspot:new I["a"],isProcessing:!1,type:"screen",screenId:null,url:"",transition:"none",overlayPosition:"top-left",offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,outsideClose:!0,scrollTop:0,scrollLeft:0,includeInTemplate:!1,template:1,isCreatingHotspotTemplate:!1,newTemplateTitle:""}},computed:B({},Object(r["d"])({activePrototypeId:function(t){return t.prototypes.activePrototypeId},activeScreenId:function(t){return t.screens.activeScreenId},hotspots:function(t){return t.hotspots.hotspots},hotspotTemplates:function(t){return t.hotspots.hotspotTemplates}}),{},Object(r["c"])({orderedScreens:"screens/orderedScreens",getScreen:"screens/getScreen",getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate"}),{selectedScreen:function(){return this.getScreen(this.screenId)}}),watch:{includeInTemplate:function(t,e){var o=this;this.$nextTick(function(){o.reposition()})},type:function(t,e){var o=this;this.$nextTick(function(){o.reposition()})},screenId:function(t,e){this.removeError("settingScreenId")}},mounted:function(){document.addEventListener("scroll",this.onEventPopoverReposition,{capture:!0,passive:!0}),window.addEventListener("resize",this.onEventPopoverReposition,{passive:!0})},beforeDestroy:function(){document.removeEventListener("scroll",this.onEventPopoverReposition,{capture:!0}),window.removeEventListener("resize",this.onEventPopoverReposition)},methods:B({},Object(r["b"])({setErrors:"form-field/setErrors",removeError:"form-field/removeError",removeHotspot:"hotspots/removeHotspot",addHotspotTemplate:"hotspots/addHotspotTemplate"}),{open:function(t,e){this.isActive||(this.isActive=!0,t instanceof I["a"]?this.hotspot=t:this.hotspot=new I["a"](t),this.reloadForm(),e&&(this.repositionToElem=e,this.reposition(e)),this.$emit("opened"))},close:function(){this.isActive&&(this.isActive=!1,this.hotspot.id||this.removeHotspot(this.hotspot.id),this.$emit("closed"))},onEventPopoverReposition:function(t){this.isActive&&this.reposition()},reposition:function(t){if(t=t||this.repositionToElem,this.isActive&&t){var e=this.$refs.popover,o=t.getBoundingClientRect(),s=5,i=o.top-s,n=o.left+o.width+s;e.style.left="0px",e.style.top="0px",n+e.offsetWidth>document.documentElement.clientWidth&&(n=o.left-e.offsetWidth-s),n=n>=0?n:0,i+e.offsetHeight>document.documentElement.clientHeight&&(i=document.documentElement.clientHeight-e.offsetHeight),i=i>=0?i:0,e.style.left=n+"px",e.style.top=i+"px"}},selectScreen:function(t){this.screenId=t,this.$refs.screensDropdown&&this.$refs.screensDropdown.hide()},reloadForm:function(){this.type=this.hotspot.type,this.screenId=l["a"].getNestedVal(this.hotspot,"settings.screenId",null),this.url=l["a"].getNestedVal(this.hotspot,"settings.url",""),this.transition=l["a"].getNestedVal(this.hotspot,"settings.transition","none"),this.overlayPosition=l["a"].getNestedVal(this.hotspot,"settings.overlayPosition","top-left"),this.offsetTop=l["a"].getNestedVal(this.hotspot,"settings.offsetTop",0)<<0,this.offsetBottom=l["a"].getNestedVal(this.hotspot,"settings.offsetBottom",0)<<0,this.offsetLeft=l["a"].getNestedVal(this.hotspot,"settings.offsetLeft",0)<<0,this.offsetRight=l["a"].getNestedVal(this.hotspot,"settings.offsetRight",0)<<0,this.scrollTop=l["a"].getNestedVal(this.hotspot,"settings.scrollTop",0)<<0,this.scrollLeft=l["a"].getNestedVal(this.hotspot,"settings.scrollLeft",0)<<0,this.outsideClose=l["a"].getNestedVal(this.hotspot,"settings.outsideClose",!0),this.includeInTemplate=this.hotspot.hotspotTemplateId>0,this.template=this.hotspot.hotspotTemplateId||(this.hotspotTemplates[0]?this.hotspotTemplates[0].id:"new"),this.newTemplateTitle="",this.setErrors({})},submitForm:function(){var t=this;if(!this.isProcessing){this.isProcessing=!0;var e=this.hotspot.id>0,o=this.includeInTemplate?this.getHotspotTemplate(this.template):null,s={screenId:o?null:this.activeScreenId,hotspotTemplateId:o?o.id:null,left:this.hotspot.left,top:this.hotspot.top,width:this.hotspot.width,height:this.hotspot.height,type:this.type,settingScreenId:this.screenId,settingUrl:this.url,settingOverlayPosition:this.overlayPosition,settingTransition:this.transition,settingOffsetTop:this.offsetTop<<0,settingOffsetBottom:this.offsetBottom<<0,settingOffsetLeft:this.offsetLeft<<0,settingOffsetRight:this.offsetRight<<0,settingScrollTop:this.scrollTop<<0,settingScrollLeft:this.scrollLeft<<0,settingOutsideClose:this.outsideClose},i=null;i=e?a["a"].Hotspots.update(this.hotspot.id,s):a["a"].Hotspots.create(s),i.then(function(e){t.hotspot.load(e.data),o&&t.linkToHotspotTemplate(o.id,t.activeScreenId),t.$toast(t.$t("Successfully updated hotspot.")),t.reloadForm(),t.close(),t.$emit("hotspotUpdated",t.hotspot)}).catch(function(e){t.$errResponseHandler(e)}).finally(function(){t.isProcessing=!1})}},onScreensDropdownShow:function(){var t=this;this.$nextTick(function(){var e=t.$el.querySelector(".dropdown-thumbs-list .thumb.active");e&&e.scrollIntoView({block:"nearest"})})},deleteHotspot:function(){this.hotspot.id&&window.confirm(this.$t("Do you really want to delete the selected hotspot?"))&&(this.close(),this.removeHotspot(this.hotspot.id),this.$toast(this.$t("Successfully deleted hotspot.")),a["a"].Hotspots.delete(this.hotspot.id))},createHotspotTemplate:function(){var t=this;!this.isCreatingHotspotTemplate&&this.newTemplateTitle&&(this.isCreatingHotspotTemplate=!0,a["a"].HotspotTemplates.create({title:this.newTemplateTitle,prototypeId:this.activePrototypeId},{expand:"screenIds"}).then(function(e){t.addHotspotTemplate(e.data),t.newTemplateTitle="",t.template=t.hotspotTemplates[t.hotspotTemplates.length-1].id,t.$toast(t.$t("Successfully created new hotspot template."))}).catch(function(e){t.$errResponseHandler(e)}).finally(function(){t.isCreatingHotspotTemplate=!1}))},linkToHotspotTemplate:function(t,e){e=e||this.activeScreenId;var o=this.getHotspotTemplate(t);o&&!l["a"].inArray(o.screenIds,e)&&(o.screenIds.push(e),a["a"].HotspotTemplates.linkScreen(o.id,e))}})},W=z,U=Object(y["a"])(W,M,R,!1,null,null,null),q=U.exports,V=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("toggler",{staticClass:"popover popover-sm hotspot-templates-popover",attrs:{hideOnChildClick:!1}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.hotspotTemplates.length,expression:"hotspotTemplates.length"}],staticClass:"hotspot-templates-list"},[t._l(t.hotspotTemplates,function(e,s){return[o("div",{staticClass:"form-group m-0 flex-block flex-nowrap"},[o("input",{attrs:{type:"checkbox",id:"link_hotspot_template_"+e.id},domProps:{value:e.id,checked:t.isHotspotTemplateLinked(e.id)},on:{change:function(o){return o.preventDefault(),t.toggleLinking(e.id)}}}),o("label",{attrs:{for:"link_hotspot_template_"+e.id}},[t._v("Â ")]),o("div",{ref:"titleElem"+e.id,refInFor:!0,staticClass:"m-r-5",attrs:{contenteditable:"true",spellcheck:"false",autocomplete:"off",title:t.$t("Click to edit"),"data-placeholder":e.title},on:{blur:function(o){return t.updateHotspotTemplateTitle(e.id)},keydown:function(o){return!o.type.indexOf("key")&&t._k(o.keyCode,"enter",13,o.key,"Enter")?null:(o.preventDefault(),t.updateHotspotTemplateTitle(e.id))}}},[t._v(t._s(e.title))]),o("small",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Total hotspots"),expression:"$t('Total hotspots')",modifiers:{top:!0}}],staticClass:"label label-light-border align-self-start"},[o("span",{staticClass:"txt txt-hint"},[t._v(t._s(t.countTemplateHotspots(e.id)))])]),o("div",{staticClass:"flex-fill-block"}),o("div",{staticClass:"list-ctrls align-self-start"},[o("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("Delete"),expression:"$t('Delete')",modifiers:{top:!0}}],staticClass:"list-ctrl-item ctrl-danger",on:{click:function(o){return o.preventDefault(),t.deleteHotspotTemplate(e.id)}}},[o("i",{staticClass:"fe fe-trash"})])])]),o("hr",{staticClass:"m-t-10",class:{"m-b-10":s+1!=t.hotspotTemplates.length}})]})],2),o("button",{staticClass:"btn btn-sm btn-transp-success btn-block btn-loader",class:{"btn-loader-active":t.isCreating},attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.createHotspotTemplate()}}},[o("i",{staticClass:"fe fe-plus"}),o("span",{staticClass:"txt"},[t._v(t._s(t.$t("New hotspot template")))])])])},X=[];function Y(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,s)}return o}function K(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?Y(o,!0).forEach(function(e){Object(n["a"])(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):Y(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var J={name:"hotspot-templates-popover",props:{screen:{type:u["a"],default:function(){return this.activeScreen}}},data:function(){return{isCreating:!1}},computed:K({},Object(r["d"])({hotspots:function(t){return t.hotspots.hotspots},hotspotTemplates:function(t){return t.hotspots.hotspotTemplates}}),{},Object(r["c"])({activeScreen:"screens/activeScreen",getHotspotTemplate:"hotspots/getHotspotTemplate"}),{linkedHotspotTemplateIds:function(){var t=[];for(var e in this.hotspotTemplates)l["a"].inArray(this.hotspotTemplates[e].screenIds,this.screen.id)&&t.push(this.hotspotTemplates[e].id);return t}}),methods:K({},Object(r["b"])({removeHotspotTemplate:"hotspots/removeHotspotTemplate",updateHotspotTemplate:"hotspots/updateHotspotTemplate",addHotspotTemplate:"hotspots/addHotspotTemplate"}),{countTemplateHotspots:function(t){for(var e=0,o=this.hotspots.length-1;o>=0;o--)this.hotspots[o].hotspotTemplateId==t&&e++;return e},deleteHotspotTemplate:function(t){var e=this.getHotspotTemplate(t);e&&window.confirm(this.$t('Do you really want to delete template "{title}" and all its hotspots?',{title:e.title}))&&(this.$toast(this.$t('Successfully deleted template "{title}".',{title:e.title})),this.removeHotspotTemplate(e.id),a["a"].HotspotTemplates.delete(e.id))},updateHotspotTemplateTitle:function(t){var e=this,o=this.getHotspotTemplate(t),s=this.$refs["titleElem"+t]?this.$refs["titleElem"+t][0]:null;o&&s&&s.innerText!==o.title&&(s.innerText.trim()?(s.blur(),a["a"].HotspotTemplates.update(o.id,{title:s.innerText},{expand:"screenIds"}).then(function(t){e.updateHotspotTemplate(t.data),o=e.getHotspotTemplate(o.id),s.innerText=o.title}).catch(function(t){e.$errResponseHandler(t)})):s.innerText=o.title)},createHotspotTemplate:function(t){var e=this;this.isCreating||(t=t||this.$t("Template")+" "+(this.hotspotTemplates.length+1),this.isCreating=!0,a["a"].HotspotTemplates.create({title:t,prototypeId:this.screen.prototypeId},{expand:"screenIds"}).then(function(t){e.addHotspotTemplate(t.data),e.$toast(e.$t("Successfully created new hotspot template."))}).catch(function(t){e.$errResponseHandler(t)}).finally(function(){e.isCreating=!1}))},isHotspotTemplateLinked:function(t){return l["a"].inArray(this.linkedHotspotTemplateIds,t)},toggleLinking:function(t){this.isHotspotTemplateLinked(t)?this.unlinkFromHotspotTemplate(t):this.linkToHotspotTemplate(t)},linkToHotspotTemplate:function(t){var e=this.screen.id,o=this.getHotspotTemplate(t);o&&!l["a"].inArray(o.screenIds,e)&&(this.$toast(this.$t("Successfully linked hotspot template.")),o.screenIds.push(e),a["a"].HotspotTemplates.linkScreen(o.id,e))},unlinkFromHotspotTemplate:function(t){var e=this.screen.id,o=this.getHotspotTemplate(t);o&&l["a"].inArray(o.screenIds,e)&&(this.$toast(this.$t("Successfully unlinked hotspot template.")),o.screenIds.splice(o.screenIds.indexOf(e<<0),1),a["a"].HotspotTemplates.unlinkScreen(o.id,e))}})},G=J,Q=(o("bd56"),Object(y["a"])(G,V,X,!1,null,null,null)),Z=Q.exports,tt=o("7bbf"),et=o("af83"),ot=o("c647"),st=o("35bb");function it(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,s)}return o}function nt(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?it(o,!0).forEach(function(e){Object(n["a"])(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):it(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var rt={computed:nt({},Object(r["d"])({activeScreenId:function(t){return t.screens.activeScreenId},hotspots:function(t){return t.hotspots.hotspots},hotspotTemplates:function(t){return t.hotspots.hotspotTemplates}}),{},Object(r["c"])({getHotspotsForScreen:"hotspots/getHotspotsForScreen"}),{activeScreenHotspots:function(){return this.getHotspotsForScreen(this.activeScreenId)},totalActiveHotspotTemplates:function(){var t=0;for(var e in this.hotspotTemplates)l["a"].inArray(this.hotspotTemplates[e].screenIds,this.activeScreenId)&&t++;return t}}),methods:nt({},Object(r["b"])({addHotspot:"hotspots/addHotspot"}),{initHotspotCreation:function(t,e){var o=this;if(this.isInHotspotsMode){e=e||this.activeScreenId;var s=new I["a"]({screenId:e,left:t.offsetX/this.scaleFactor,top:t.offsetY/this.scaleFactor});this.addHotspot(s),this.$nextTick(function(){if(o.$refs.hotspotBoxes){var e=o.$refs.hotspotBoxes[o.$refs.hotspotBoxes.length-1];e&&(e.activate(),e.initResizing(t))}})}},viewHotspot:function(t){if(this.$refs.hotspotBoxes)for(var e in this.$refs.hotspotBoxes){this.$refs.hotspotBoxes[e];if(hotspotBox.hotspot&&hotspotBox.hotspot.id==t){hotspotBox.activate();break}}},deactivateHotspots:function(){if(this.$refs.hotspotPopover&&this.$refs.hotspotPopover.close(),this.$refs.hotspotBoxes)for(var t in this.$refs.hotspotBoxes)this.$refs.hotspotBoxes[t].deactivate()},onHotspotPopoverClose:function(){this.deactivateHotspots()},onHotspotActivate:function(t,e){this.deactivateHotspots(),this.$refs.hotspotPopover&&this.$refs.hotspotPopover.open(t,e)},onHotspotRepositioning:function(t,e){var o=this;this.$nextTick(function(){o.$refs.hotspotPopover&&o.$refs.hotspotPopover.reposition(e)})},getActiveHotspotBox:function(){if(this.$refs.hotspotBoxes)for(var t in this.$refs.hotspotBoxes)if(this.$refs.hotspotBoxes[t].isActive)return this.$refs.hotspotBoxes[t];return null},snapActiveHotspot:function(t){if(this.isInHotspotsMode){var e=this.getActiveHotspotBox();e&&e.snap()}}})};function at(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,s)}return o}function lt(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?at(o,!0).forEach(function(e){Object(n["a"])(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):at(o).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}var ct="preview",pt="hotspots",dt="comments",ht={name:"screens-view",mixins:[ot["a"],st["a"],rt],components:{"screen-preview":c["a"],"screens-panel":p["a"],"screen-edit-popover":w,"comment-pin":tt["a"],"comment-popover":et["a"],"hotspot-box":L,"hotspot-popover":q,"hotspot-templates-popover":Z},data:function(){return{isLoadingScreens:!1,mode:ct}},computed:lt({},Object(r["d"])({loggedUser:function(t){return t.user.user},activePrototypeId:function(t){return t.prototypes.activePrototypeId},screens:function(t){return t.screens.screens},activeScreenId:function(t){return t.screens.activeScreenId}}),{},Object(r["c"])({activePrototype:"prototypes/activePrototype",getScreen:"screens/getScreen",activeScreen:"screens/activeScreen",activeScreenOrderedIndex:"screens/activeScreenOrderedIndex"}),{isInCommentsMode:function(){return this.mode===dt},isInHotspotsMode:function(){return this.mode===pt},isInPreviewMode:function(){return this.mode===ct},modeHelpTooltip:function(){return this.isInCommentsMode?this.$t("Click to leave a comment"):this.isInHotspotsMode?this.$t('Click and drag to create a hotspot\n(hold "Ctrl" to snap)'):""}}),watch:{mode:function(t,e){this.updateRouteMode()},activeScreenId:function(t,e){this.deactivateHotspots(),this.deactivateComments(),this.updateRouteScreenId()},"$route.params.screenId":function(t,e){t&&this.getScreen(t)?t!=this.activeScreenId&&this.setActiveScreenId(t):this.updateRouteScreenId()},"$route.query.mode":function(t,e){t===dt?this.setCommentsMode():t===ct?this.setPreviewMode():t===pt?this.setHotspotsMode():this.updateRouteMode()}},beforeMount:function(){this.$route.query.mode===dt||this.$route.query.commentId?this.setCommentsMode():this.$route.query.mode===pt?this.setHotspotsMode():this.setPreviewMode(),this.init()},methods:lt({},Object(r["b"])({setScreens:"screens/setScreens",setActiveScreenId:"screens/setActiveScreenId",addPrototype:"prototypes/addPrototype",setActivePrototypeId:"prototypes/setActivePrototypeId"}),{init:function(){var t=this;this.$setDocumentTitle(function(){return t.$t("Screen")}),this.loadScreens(this.$route.params.prototypeId,this.$route.params.screenId),this.loadHotspots(this.$route.params.prototypeId),this.loadHotspotTemplates(this.$route.params.prototypeId),this.loadComments(this.$route.params.prototypeId),this.loadMentionsList(this.$route.params.projectId)},loadMentionsList:function(t){var e=this;t=t||(this.activePrototype?this.activePrototype.projectId:null),t&&a["a"].Projects.getCollaboratorsList(t).then(function(t){e.mentionsList=e.convertCollaboratorsListToMentionsList(t.data,[e.loggedUser.email])})},loadScreens:function(t,e){var o=this;t=t||this.activePrototypeId,t&&!this.isLoadingScreens&&(this.isLoadingScreens=!0,a["a"].Prototypes.getOne(t,{expand:"screens"}).then(function(t){o.addPrototype(t.data),o.setActivePrototypeId(l["a"].getNestedVal(t,"data.id")),o.setScreens(l["a"].getNestedVal(t,"data.screens",[])),o.getScreen(e)&&o.setActiveScreenId(e),o.updateRouteProjectId(),o.updateRouteScreenId(),o.updateRouteMode()}).catch(function(t){o.$errResponseHandler(t)}).finally(function(){o.isLoadingScreens=!1}))},updateRouteProjectId:function(){this.activePrototype&&this.$route.params.projectId!=this.activePrototype.projectId&&this.$router["replace"]({to:this.$route.name,params:Object.assign({},this.$route.params,{projectId:this.activePrototype.projectId}),query:Object.assign({},this.$route.query)})},updateRouteScreenId:function(){var t=this.$route.params.screenId;t!=this.activeScreenId&&this.$router[t?"push":"replace"]({to:this.$route.name,params:Object.assign({},this.$route.params,{screenId:this.activeScreenId}),query:Object.assign({},this.$route.query)})},updateRouteMode:function(){this.$route.query.mode!=this.mode&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:Object.assign({},this.$route.query,{mode:this.mode})})},setCommentsMode:function(){this.mode=dt},setHotspotsMode:function(){this.mode=pt},setPreviewMode:function(){this.mode=ct},onEscPress:function(t){this.isInHotspotsMode?(t.preventDefault(),this.deactivateHotspots()):this.isInCommentsMode&&(t.preventDefault(),this.deactivateComments())},onActiveScreenMousedown:function(t){this.isInHotspotsMode&&this.initHotspotCreation(t,this.activeScreenId)},onActiveScreenClick:function(t){this.isInPreviewMode?this.blinkPreviewModeHints():this.isInCommentsMode&&this.initCommentCreation(t,this.activeScreenId)}})},ut=ht,mt=Object(y["a"])(ut,s,i,!1,null,null,null);e["default"]=mt.exports},f245:function(t,e,o){}}]);