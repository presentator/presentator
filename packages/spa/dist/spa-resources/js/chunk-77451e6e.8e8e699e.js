(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77451e6e"],{"18f8":function(e,t,s){"use strict";function o(e,t,s,o,i,r,n){try{var a=e[r](n),l=a.value}catch(c){return void s(c)}a.done?t(l):Promise.resolve(l).then(o,i)}function i(e){return function(){var t=this,s=arguments;return new Promise((function(i,r){var n=e.apply(t,s);function a(e){o(n,i,r,a,l,"next",e)}function l(e){o(n,i,r,a,l,"throw",e)}a(void 0)}))}}var r=s("79e3"),n=s.n(r),a=s("dd93"),l=s("f744");t["a"]={data(){return{dropzone:null,isReplacing:!1,isReplaceHandleClickable:!0}},mounted(){n.a.autoDiscover=!1},destroyed(){this.destroyReplace()},methods:{destroyReplace(){this.isReplacing=!1,this.dropzone&&this.dropzone.destroy()},initReplace(e,t){var s=this;t=t||this.$refs.replaceHandle,this.destroyReplace(),t&&e&&e.id&&(this.dropzone=new n.a(t,{url:l["a"].$baseUrl+"/screens/"+encodeURIComponent(e.id),clickable:this.isReplaceHandleClickable,method:"put",paramName:"file",maxFiles:1,timeout:0,parallelUploads:1,uploadMultiple:!1,thumbnailWidth:null,thumbnailHeight:null,addRemoveLinks:!1,createImageThumbnails:!1,previewTemplate:'<div style="display: none"></div>',accept:function(){var t=i((function*(t,o){const i=window.URL.createObjectURL(t),r=yield a["a"].loadImage(i);window.URL.revokeObjectURL(i);const n=yield a["a"].loadImage(e.getImage("original")),l=r.width<n.width||r.height<n.height;!l||window.confirm(s.$t("Replacing could result in hotspots and comments misplacement if the new screen image has different dimensions from the original.")+"\n"+s.$t("Do you still want to proceed?"))?o():s.dropzone.removeAllFiles(!0)}));function o(e,s){return t.apply(this,arguments)}return o}()}),this.dropzone.on("addedfile",function(){var e=i((function*(e){s.dropzone.options.headers=Object.assign(s.dropzone.options.headers||{},{Authorization:"Bearer "+l["a"].$token})}));return function(t){return e.apply(this,arguments)}}()),this.dropzone.on("sending",(e,t,s)=>{this.isReplacing=!0}),this.dropzone.on("queuecomplete",()=>{this.isReplacing=!1,this.dropzone.removeAllFiles(!0)}),this.dropzone.on("success",(t,s)=>{e.load(s),this.replaceSucceeded()}),this.dropzone.on("error",(e,t,s)=>{const o=a["a"].getNestedVal(t,"errors.file",this.$t("An error occurred while uploading the screen."));this.$toast(o,"danger"),this.dropzone.removeAllFiles(!0)}))},replaceSucceeded(){}}}},"60c4":function(e,t,s){},"9d2a":function(e,t,s){"use strict";s("60c4")},a68a:function(e,t,s){"use strict";s("add5")},add5:function(e,t,s){},ce01:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isLoadingScreens?s("div",{staticClass:"full-page-flex"},[s("div",{staticClass:"flex-fill-block"}),e._m(0),s("div",{staticClass:"flex-fill-block"})]):e.activeScreen?s("div",{staticClass:"preview-container-wrapper"},[s("div",{ref:"previewContainer",staticClass:"preview-container",class:{"comments-mode":e.isInCommentsMode,"hotspots-mode":e.isInHotspotsMode,"preview-mode":e.isInPreviewMode,"preview-mode-hints":e.isPreviewModeHintsActive},style:{background:e.activePrototype.isForDesktop&&e.activeScreen?e.activeScreen.background:null},attrs:{tabindex:"-1"},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.onEscPress.apply(null,arguments)},function(e){return(e.type.indexOf("key")||83===e.keyCode)&&e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:void e.preventDefault():null}],keyup:function(t){return(t.type.indexOf("key")||83===t.keyCode)&&t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.snapActiveHotspot.apply(null,arguments)):null}}},[s("div",{staticClass:"flex-fill-block"}),s("hotspot-popover",{ref:"hotspotPopover",on:{closed:e.onHotspotPopoverClose}}),s("active-comment-popover",{ref:"commentPopover",attrs:{isForPreview:!1,mentionsList:e.mentionsList}}),s("screen-preview",{ref:"screenPreview",attrs:{interactions:e.isInPreviewMode,activeScreenTooltip:e.modeHelpTooltip,fitToScreen:e.fitToScreen},on:{activeScreenMousedown:e.onActiveScreenMousedown,activeScreenClick:e.onActiveScreenClick}},[e.isInHotspotsMode?s("div",{staticClass:"block hotspots-block"},e._l(e.activeScreenHotspots,(function(t){return s("hotspot-box",{key:t.id,ref:"hotspotBoxes",refInFor:!0,attrs:{hotspot:t,snapToImage:e.$refs.screenPreview?e.$refs.screenPreview.$refs.activeScreen:null},on:{repositioning:e.onHotspotRepositioning,repositionStopped:e.onHotspotRepositioning,beforeActivate:e.onHotspotActivate}})})),1):e._e(),e.isInCommentsMode?s("div",{staticClass:"block comments-block"},e._l(e.activeScreenComments,(function(t){return s("comment-pin",{key:t.id,ref:"screenCommentPins",refInFor:!0,class:{"soft-hidden":!e.showResolvedComments&&t.isResolved,unread:e.isCommentUnread(t.id)},attrs:{comment:t,allowPositionChange:!0},on:{repositioning:e.onCommentRepositioning}})})),1):e._e()]),s("div",{staticClass:"flex-fill-block"}),s("nav",{staticClass:"floating-bar preview-bar active",class:{"responsive-show-more":e.isResponsiveShowMoreActive}},[s("div",{staticClass:"nav nav-left"},[s("router-link",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Back to listing"),expression:"$t('Back to listing')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-close",attrs:{to:{name:"prototype",params:{projectId:e.activePrototype.projectId,prototypeId:e.activePrototype.id}}}},[s("i",{staticClass:"fe fe-arrow-left"})]),e.activeScreen?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t(e.$refs.screensPanel&&e.$refs.screensPanel.isActive?"Hide screens panel":"Show screens panel"),expression:"$t($refs.screensPanel && $refs.screensPanel.isActive ? 'Hide screens panel' : 'Show screens panel')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-screens",class:{active:e.$refs.screensPanel&&e.$refs.screensPanel.isActive},on:{click:function(t){t.preventDefault(),e.$refs.screensPanel&&e.$refs.screensPanel.toggle()}}},[s("span",{staticClass:"txt screen-title"},[e._v(e._s(e.activeScreen.title))]),s("span",{staticClass:"txt counter m-l-5"},[e._v("("+e._s(e.$t("{current} of {total}",{current:e.activeScreenOrderedIndex+1,total:e.screens.length}))+")")]),s("i",{staticClass:"m-l-5 fe",class:e.$refs.screensPanel&&e.$refs.screensPanel.isActive?"fe-chevron-up":"fe-chevron-down"})]):e._e()],1),s("div",{staticClass:"nav nav-center"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Preview mode ({shortcut})",{shortcut:"P"}),expression:"$t('Preview mode ({shortcut})', {shortcut: 'P'})",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.80",value:e.setPreviewMode,expression:"setPreviewMode",modifiers:{80:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-success",class:{highlight:e.isInPreviewMode},on:{click:function(t){return t.preventDefault(),e.setPreviewMode()}}},[s("i",{staticClass:"fe fe-eye"})]),s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Hotspots mode ({shortcut})",{shortcut:"H"}),expression:"$t('Hotspots mode ({shortcut})', {shortcut: 'H'})",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.72",value:e.setHotspotsMode,expression:"setHotspotsMode",modifiers:{72:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-primary",class:{highlight:e.isInHotspotsMode},on:{click:function(t){return t.preventDefault(),e.setHotspotsMode()}}},[e.isLoadingHotspots||e.isLoadingHotspotTemplates?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-target"})]),s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Comments mode ({shortcut})",{shortcut:"C"}),expression:"$t('Comments mode ({shortcut})', {shortcut: 'C'})",modifiers:{top:!0}},{name:"shortcut",rawName:"v-shortcut.67",value:e.setCommentsMode,expression:"setCommentsMode",modifiers:{67:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-danger",class:{highlight:e.isInCommentsMode},on:{click:function(t){return t.preventDefault(),e.setCommentsMode()}}},[!e.isLoadingComments&&e.totalActiveScreenUnresolvedComments>0?s("span",{staticClass:"pin",class:{animate:e.totalActiveScreenUnreadComments>0}},[e._v(" "+e._s(e.totalActiveScreenUnresolvedComments)+" ")]):e._e(),e.isLoadingComments?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-message-circle"})]),s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("More tools"),expression:"$t('More tools')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle ctrl-item-responsive-show-more responsive-only",on:{click:function(t){return t.preventDefault(),e.responsiveShowMore.apply(null,arguments)}}},[s("i",{staticClass:"fe fe-more-horizontal"})])]),s("div",{staticClass:"nav nav-right"},[e.isInCommentsMode&&e.$refs.commentsPanel?s("button",{staticClass:"btn btn-sm no-shadow comments-panel-toggle",class:e.$refs.commentsPanel.isActive?"btn-danger":"btn-transp-danger",on:{click:function(t){return t.preventDefault(),e.$refs.commentsPanel.toggle()}}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Comments panel")))])]):e._e(),e.isInHotspotsMode?s("div",{staticClass:"ctrl-item ctrl-item-templates txt-default"},[s("span",{staticClass:"txt title m-r-5"},[e._v(" "+e._s(e.$tc("0 Active hotspot templates | 1 Active hotspot template | {count} Active hotspot templates",e.totalActiveHotspotTemplates))+" ")]),s("i",{staticClass:"fe fe-chevron-up"}),s("hotspot-templates-popover",{staticClass:"transform-bottom-right",attrs:{screen:e.activeScreen}})],1):e._e(),0!=e.activePrototype.scaleFactor?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Toggle fit to screen"),expression:"$t('Toggle fit to screen')",modifiers:{top:!0}}],staticClass:"ctrl-item ctrl-item-circle",class:e.fitToScreen?"ctrl-item-success active bg-light-border":"",on:{click:function(t){return t.preventDefault(),e.toggleFitToScreen.apply(null,arguments)}}},[s("i",{staticClass:"fe fe-maximize"})]):e._e(),s("div",{staticClass:"ctrl-item ctrl-item-circle"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Screen settings"),expression:"$t('Screen settings')",modifiers:{top:!0}}]},[e.$refs.screenEditPopover&&e.$refs.screenEditPopover.isProcessing?s("span",{staticClass:"loader"}):s("i",{staticClass:"fe fe-settings"})]),s("screen-edit-popover",{ref:"screenEditPopover",staticClass:"transform-bottom-right",attrs:{screen:e.activeScreen}})],1),s("div",{staticClass:"flex-fill-block responsive-only"}),s("div",{staticClass:"ctrl-item ctrl-item-circle ctrl-item-responsive-hide-more responsive-only",on:{click:function(t){return t.preventDefault(),e.responsiveHideMore.apply(null,arguments)}}},[s("i",{staticClass:"fe fe-x"})])])]),s("screens-panel",{ref:"screensPanel"})],1),s("comments-panel",{ref:"commentsPanel"})],1):e._e()},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"block txt-center"},[s("span",{staticClass:"loader loader-lg loader-blend"})])}],r=(s("ac6a"),s("a481"),s("097d"),s("ade3")),n=s("2f62"),a=s("f744"),l=s("dd93"),c=s("0372"),p=s("9aaf"),d=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("toggler",{ref:"popover",staticClass:"popover screen-edit-popover",attrs:{tag:"form",hideOnChildClick:!1},nativeOn:{submit:function(t){return t.preventDefault(),e.saveChanges()}}},[s("form-field",{attrs:{name:"title"}},[s("label",{attrs:{for:"screen_title"}},[e._v(e._s(e.$t("Title")))]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.screen.title,expression:"screen.title",modifiers:{trim:!0}}],attrs:{type:"text",id:"screen_title",maxlength:"255",required:""},domProps:{value:e.screen.title},on:{change:function(t){return e.saveChanges()},input:function(t){t.target.composing||e.$set(e.screen,"title",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),s("div",{staticClass:"row"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"form-group form-group"},[s("label",{attrs:{for:"screen_alignment"}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Alignment")))]),s("screen-bulk-setting-handle",{attrs:{screen:e.screen,setting:"alignment"}})],1),s("div",{staticClass:"switch-group"},[s("div",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.screen.alignment,expression:"screen.alignment"}],attrs:{type:"radio",value:"left",id:"screen_alignment_radio_left"},domProps:{checked:e._q(e.screen.alignment,"left")},on:{change:[function(t){return e.$set(e.screen,"alignment","left")},function(t){return e.saveChanges()}]}}),s("label",{attrs:{for:"screen_alignment_radio_left"}},[e._v(e._s(e.$t("Left")))])]),s("div",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.screen.alignment,expression:"screen.alignment"}],attrs:{type:"radio",value:"center",id:"screen_alignment_radio_center"},domProps:{checked:e._q(e.screen.alignment,"center")},on:{change:[function(t){return e.$set(e.screen,"alignment","center")},function(t){return e.saveChanges()}]}}),s("label",{attrs:{for:"screen_alignment_radio_center"}},[e._v(e._s(e.$t("Center")))])]),s("div",{staticClass:"switch"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.screen.alignment,expression:"screen.alignment"}],attrs:{type:"radio",value:"right",id:"screen_alignment_radio_right"},domProps:{checked:e._q(e.screen.alignment,"right")},on:{change:[function(t){return e.$set(e.screen,"alignment","right")},function(t){return e.saveChanges()}]}}),s("label",{attrs:{for:"screen_alignment_radio_right"}},[e._v(e._s(e.$t("Right")))])])])])]),s("div",{staticClass:"col-6"},[s("form-field",{attrs:{name:"background"}},[s("label",{attrs:{for:"screen_background"}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Background")))]),s("screen-bulk-setting-handle",{attrs:{screen:e.screen,setting:"background"}})],1),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.screen.background,expression:"screen.background"}],attrs:{type:"color",id:"screen_background"},domProps:{value:e.screen.background},on:{change:function(t){return e.saveChanges()},input:function(t){t.target.composing||e.$set(e.screen,"background",t.target.value)}}}),s("label",{staticClass:"input-addon txt-monospace p-l-0",attrs:{for:"screen_background"}},[e._v(e._s(e.screen.background))])])])],1)]),s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.hasFixedHeader,expression:"hasFixedHeader"}],attrs:{type:"checkbox",id:"screen_fixed_header_check"},domProps:{checked:Array.isArray(e.hasFixedHeader)?e._i(e.hasFixedHeader,null)>-1:e.hasFixedHeader},on:{change:[function(t){var s=e.hasFixedHeader,o=t.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);o.checked?n<0&&(e.hasFixedHeader=s.concat([r])):n>-1&&(e.hasFixedHeader=s.slice(0,n).concat(s.slice(n+1)))}else e.hasFixedHeader=i},function(t){return e.onFixedHeaderToggleChange()}]}}),s("label",{attrs:{for:"screen_fixed_header_check"}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Has fixed header")))]),s("screen-bulk-setting-handle",{attrs:{screen:e.screen,setting:"fixedHeader"}})],1)])]),s("div",{staticClass:"col-6"},[s("form-field",{directives:[{name:"show",rawName:"v-show",value:e.hasFixedHeader,expression:"hasFixedHeader"}],staticClass:"form-group-sm",attrs:{name:"fixedHeader"}},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.screen.fixedHeader,expression:"screen.fixedHeader",modifiers:{number:!0}}],attrs:{type:"number",min:"0"},domProps:{value:e.screen.fixedHeader},on:{change:function(t){return e.saveChanges()},input:function(t){t.target.composing||e.$set(e.screen,"fixedHeader",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[e._v("px")])])])],1)]),s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"form-group m-b-0"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.hasFixedFooter,expression:"hasFixedFooter"}],attrs:{type:"checkbox",id:"screen_fixed_footer_check"},domProps:{checked:Array.isArray(e.hasFixedFooter)?e._i(e.hasFixedFooter,null)>-1:e.hasFixedFooter},on:{change:[function(t){var s=e.hasFixedFooter,o=t.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);o.checked?n<0&&(e.hasFixedFooter=s.concat([r])):n>-1&&(e.hasFixedFooter=s.slice(0,n).concat(s.slice(n+1)))}else e.hasFixedFooter=i},function(t){return e.onFixedFooterToggleChange()}]}}),s("label",{attrs:{for:"screen_fixed_footer_check"}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Has fixed footer")))]),s("screen-bulk-setting-handle",{attrs:{screen:e.screen,setting:"fixedFooter"}})],1)])]),s("div",{staticClass:"col-6"},[s("form-field",{directives:[{name:"show",rawName:"v-show",value:e.hasFixedFooter,expression:"hasFixedFooter"}],staticClass:"form-group-sm m-b-0",attrs:{name:"fixedFooter"}},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.screen.fixedFooter,expression:"screen.fixedFooter",modifiers:{number:!0}}],attrs:{type:"number",min:"0"},domProps:{value:e.screen.fixedFooter},on:{change:function(t){return e.saveChanges()},input:function(t){t.target.composing||e.$set(e.screen,"fixedFooter",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[e._v("px")])])])],1)]),s("hr",{staticClass:"m-t-20 m-b-20"}),s("div",{staticClass:"flex-block"},[s("div",{staticClass:"flex-fill-block txt-left"},[e.isReplacing?s("span",{staticClass:"loader txt-hint"}):s("span",{ref:"replaceHandle",staticClass:"link-hint"},[e._v(e._s(e.$t("Replace screen")))])])])],1)},h=[],m=s("2714"),u=s("18f8"),v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Apply to all screens"),expression:"$t('Apply to all screens')",modifiers:{top:!0}}],staticClass:"m-l-5",class:e.isProcessing?"txt-fade":"link-primary",on:{click:function(t){return t.preventDefault(),e.bulkApply()}}},[s("i",{staticClass:"fe fe-copy"})])},f=[];function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var b={name:"screen-bulk-setting-handle",props:{screen:{type:m["a"],required:!0},setting:{type:String,required:!0}},data(){return{isProcessing:!1}},computed:y({},Object(n["d"])({screens:e=>e.screens.screens})),methods:{bulkApply(){if(this.isProcessing||"undefined"==typeof this.screen[this.setting])return;this.isProcessing=!0;const e={prototypeId:this.screen.prototypeId};e[this.setting]=this.screen[this.setting],a["a"].enableAutoCancellation(!1),a["a"].Screens.bulkUpdate(e).then(e=>{for(let t=this.screens.length-1;t>=0;t--)this.$set(this.screens[t],this.setting,this.screen[this.setting]);this.$toast("Successfully updated all screens.")}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isProcessing=!1})}}},_=b,w=s("2877"),C=Object(w["a"])(_,v,f,!1,null,null,null),$=C.exports;function x(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function P(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?x(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var O={name:"screen-edit-popover",mixins:[u["a"]],components:{"screen-bulk-setting-handle":$},props:{screen:{type:m["a"],required:!0}},data(){return{isProcessing:!1,hasFixedHeader:!1,hasFixedFooter:!1}},watch:{screen(e,t){this.initForm(),this.initReplace(this.screen)}},mounted(){this.initForm(),this.initReplace(this.screen)},methods:P(P({},Object(n["b"])({setErrors:"form-field/setErrors"})),{},{replaceSucceeded(){this.$refs.popover&&this.$refs.popover.hide(),this.$emit("updated",this.screen.id)},initForm(){this.setErrors({}),this.hasFixedHeader=this.screen.fixedHeader>0,this.hasFixedFooter=this.screen.fixedFooter>0},onFixedHeaderToggleChange(){!this.hasFixedHeader&&this.screen.fixedHeader>0&&(this.screen.fixedHeader=0,this.saveChanges())},onFixedFooterToggleChange(){!this.hasFixedFooter&&this.screen.fixedFooter>0&&(this.screen.fixedFooter=0,this.saveChanges())},saveChanges(){if(!this.isProcessing){this.isProcessing=!0;var e=this.screen;a["a"].Screens.update(e.id,{title:e.title,background:e.background,alignment:e.alignment,fixedHeader:this.hasFixedHeader?e.fixedHeader:0,fixedFooter:this.hasFixedFooter?e.fixedFooter:0}).then(t=>{e.load(t.data),this.setErrors({}),this.$emit("updated",e.id)}).catch(e=>{this.$errResponseHandler(e),this.$refs.popover&&!this.$refs.popover.isActive&&this.$refs.popover.show()}).finally(()=>{this.isProcessing=!1})}}})},T=O,k=(s("a68a"),Object(w["a"])(T,d,h,!1,null,"d6a507ea",null)),H=k.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("dragger",{staticClass:"hotspot",class:{new:!e.hotspot.id,highlight:e.hotspot.hotspotTemplateId>0,active:e.isActive},style:{left:e.hotspot.left*e.scaleFactor+"px",top:e.hotspot.top*e.scaleFactor+"px",width:e.hotspot.width*e.scaleFactor+"px",height:e.hotspot.height*e.scaleFactor+"px"},attrs:{wrapperSelector:".screen-inner-wrapper"},on:{dragging:e.onRepositioning,dragStarted:e.onRepositionStart,dragStopped:e.onRepositionStop},nativeOn:{click:function(t){return t.preventDefault(),e.activate()}}},[s("resizer",{ref:"resizeHandle",staticClass:"resize-handle",attrs:{wrapperSelector:".screen-inner-wrapper",containerSelector:".hotspot",tolerance:0},on:{resizing:e.onRepositioning,resizeStarted:e.onRepositionStart,resizeStopped:e.onRepositionStop}})],1)},I=[],j=s("82bb"),A=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{on:{mousedown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])||"button"in t&&0!==t.button?null:e.dragInit.apply(null,arguments)},touchstart:e.dragInit}},[e._t("default")],2)},F=[],R={name:"resizer",props:{containerSelector:{type:String},wrapperSelector:{type:String},tolerance:{type:Number,default:5}},data(){return{resizeStarted:!1,lockX:!1,lockY:!1,startX:0,startY:0,initialContainerX:0,initialContainerY:0,initialContainerWidth:0,initialContainerHeight:0,initialWrapperWidth:0,initialWrapperHeight:0}},computed:{container(){return this.$el.closest(this.containerSelector)||this.$el.parentNode},wrapper(){return this.container.closest(this.wrapperSelector)||this.container.parentNode}},methods:{dragInit(e){e.stopPropagation(),this.startX=e.clientX,this.startY=e.clientY,this.initialContainerX=this.container.offsetLeft,this.initialContainerY=this.container.offsetTop,this.initialContainerWidth=this.container.offsetWidth,this.initialContainerHeight=this.container.offsetHeight,this.initialWrapperWidth=this.wrapper.scrollWidth||this.wrapper.offsetWidth,this.initialWrapperHeight=this.wrapper.scrollHeight||this.wrapper.offsetHeight,document.addEventListener("touchmove",this.onMove),document.addEventListener("mousemove",this.onMove),document.addEventListener("touchend",this.onDrop),document.addEventListener("mouseup",this.onDrop)},onMove(e){let t=e.clientX-this.startX,s=e.clientY-this.startY,o=null,i=null,r=null,n=null;!this.resizeStarted&&Math.abs(t)<this.tolerance&&Math.abs(s)<this.tolerance||(e.preventDefault(),this.resizeStarted||(this.resizeStarted=!0,this.container.classList.add("no-pointer-events"),this.wrapper.classList.add("resizing"),document.body.classList.add("resizer-active"),this.$emit("resizeStarted",e)),this.$emit("resizing",e),e.shiftKey?this.lockX||this.lockY||(Math.abs(t)>Math.abs(s)?(this.lockX=!1,this.lockY=!0):(this.lockX=!0,this.lockY=!1)):(this.lockX=!1,this.lockY=!1),this.lockX||(t<0&&t<-this.initialContainerWidth?(r=-(this.initialContainerWidth+t),o=this.initialContainerX-r,o<0&&(o=null,r=null)):(r=this.initialContainerWidth+t,r+this.initialContainerX>this.initialWrapperWidth&&(r=null,o=null))),this.lockY||(s<0&&s<-this.initialContainerHeight?(n=-(this.initialContainerHeight+s),i=this.initialContainerY-n,i<0&&(i=null,n=null)):(n=this.initialContainerHeight+s,n+this.initialContainerY>this.initialWrapperHeight&&(n=null,i=null))),null!==o&&(this.container.style.left=o+"px"),null!==r&&(this.container.style.width=r+"px"),null!==i&&(this.container.style.top=i+"px"),null!==n&&(this.container.style.height=n+"px"))},onDrop(e){this.resizeStarted&&(e.preventDefault(),this.resizeStarted=!1,this.lockX=!1,this.lockY=!1,this.container.classList.remove("no-pointer-events"),this.wrapper.classList.remove("resizing"),document.body.classList.remove("resizer-active"),this.$emit("resizeStopped",e)),document.removeEventListener("touchmove",this.onMove),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("touchend",this.onDrop),document.removeEventListener("mouseup",this.onDrop)}}},L=R,D=Object(w["a"])(L,A,F,!1,null,null,null),N=D.exports,M=s("49cb");function E(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function z(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?E(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):E(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var B={name:"hotspot-box",components:{dragger:j["a"],resizer:N},props:{hotspot:{type:M["a"],required:!0},snapToImage:{}},data(){return{isActive:!1}},computed:z({},Object(n["d"])({scaleFactor:e=>e.screens.scaleFactor})),methods:{activate(){this.isActive||(this.$emit("beforeActivate",this.hotspot,this.$el),this.isActive=!0,this.positionWithinView(),this.$emit("activated",this.hotspot,this.$el))},deactivate(){this.isActive&&(this.$emit("beforeDeactivate",this.hotspot,this.$el),this.isActive=!1,this.hotspot.id||this.$emit("hotspotDeleted",this.hotspot,this.$el),this.$emit("deactivated",this.hotspot,this.$el))},positionWithinView(){this.$el.scrollIntoView({behavior:"smooth",block:"nearest"})},initResizing(e){this.$refs.resizeHandle.dragInit(e),this.$refs.resizeHandle.onMove(e)},onRepositionStart(e){this.$emit("repositionStarted",this.hotspot,this.$el)},onRepositioning(e){this.$emit("repositioning",this.hotspot,this.$el)},onRepositionStop(e){this.$set(this.hotspot,"left",Math.max(this.$el.offsetLeft,0)/this.scaleFactor),this.$set(this.hotspot,"top",Math.max(this.$el.offsetTop,0)/this.scaleFactor),this.$set(this.hotspot,"width",this.$el.offsetWidth/this.scaleFactor),this.$set(this.hotspot,"height",this.$el.offsetHeight/this.scaleFactor),e.ctrlKey?this.$nextTick(()=>{this.snap()}):this.savePosition(),this.$emit("repositionStopped",this.hotspot,this.$el)},snap(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.snapToImage){let e=l["a"].closestFeatureEdge(this.snapToImage,{x:this.hotspot.left,y:this.hotspot.top,w:this.hotspot.width,h:this.hotspot.height});this.$set(this.hotspot,"left",e.x+this.hotspot.left),this.$set(this.hotspot,"top",e.y+this.hotspot.top),this.$set(this.hotspot,"width",e.w),this.$set(this.hotspot,"height",e.h),this.$emit("repositionStopped",this.hotspot,this.$el)}e&&this.savePosition()},savePosition(){this.hotspot.id&&(this.$emit("hotspotUpdated",this.hotspot,this.$el),a["a"].Hotspots.update(this.hotspot.id,{width:this.hotspot.width,height:this.hotspot.height,left:this.hotspot.left,top:this.hotspot.top}).then(e=>{this.hotspot.load(e.data)}))}}},U=B,W=Object(w["a"])(U,S,I,!1,null,null,null),q=W.exports,V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popover-holder hotspot-popover-holder"},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"popover-overlay",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.close()}}}),s("div",{ref:"popover",staticClass:"popover hotspot-popover",class:{active:e.isActive}},[s("form",{on:{submit:function(t){return t.preventDefault(),e.submitForm()}}},[s("form-field",{attrs:{name:"type"}},[s("div",{staticClass:"input-group"},[s("label",{staticClass:"input-addon bg-border txt-default"},[e._v(e._s(e.$t("Link to")))]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{id:"hotspot_type_"+e.hotspot.id,required:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.type=t.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"screen"}},[e._v(e._s(e.$t("Screen")))]),s("option",{attrs:{value:"overlay"}},[e._v(e._s(e.$t("Screen as overlay")))]),s("option",{attrs:{value:"prev"}},[e._v(e._s(e.$t("Prev screen in series")))]),s("option",{attrs:{value:"next"}},[e._v(e._s(e.$t("Next screen in series")))]),s("option",{attrs:{value:"back"}},[e._v(e._s(e.$t("Back (last visited screen)")))]),s("option",{attrs:{value:"scroll"}},[e._v(e._s(e.$t("Position (scroll to)")))]),e.$getAppConfig("VUE_APP_ALLOW_HOTSPOTS_URL")<<0?s("option",{attrs:{value:"url"}},[e._v(e._s(e.$t("External URL")))]):e._e()])])]),s("form-field",{directives:[{name:"show",rawName:"v-show",value:"screen"===e.type||"overlay"===e.type,expression:"type === 'screen' || type === 'overlay'"}],attrs:{name:"settingScreenId"}},[s("label",[e._v(e._s(e.$t("Screen")))]),s("div",{staticClass:"btn btn-block btn-light-border btn-dropdown",attrs:{tabindex:"0"},on:{keydown:[function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.preventDefault(),!e.$refs.screensDropdown||e.$refs.screensDropdown.show()},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault(),!e.$refs.screensDropdown||e.$refs.screensDropdown.toggle()}]}},[s("span",{staticClass:"txt"},[e._v(e._s(e.selectedScreen?e.selectedScreen.title:e.$t("Select a screen...")))]),s("toggler",{ref:"screensDropdown",staticClass:"dropdown dropdown-thumbs-list",on:{show:e.onScreensDropdownShow}},e._l(e.orderedScreens,(function(t){return s("figure",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.title,expression:"screen.title",modifiers:{top:!0}}],key:"hotspot_screen_"+t.id,staticClass:"thumb thumb-handle",class:{active:t.id==e.screenId},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.selectScreen(t.id)}}},[t.getImage("small")?s("img",{staticClass:"img",attrs:{src:t.getImage("small"),alt:t.title}}):s("i",{staticClass:"fe fe-image img"})])})),0)],1)]),s("div",{staticClass:"row"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"overlay"===e.type,expression:"type === 'overlay'"}],staticClass:"col-6"},[s("form-field",{attrs:{name:"settingOverlayPosition"}},[s("label",{attrs:{for:"hotspot_screen_overlay_position_"+e.hotspot.id}},[e._v(e._s(e.$t("Position")))]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.overlayPosition,expression:"overlayPosition"}],attrs:{id:"hotspot_screen_overlay_position_"+e.hotspot.id},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.overlayPosition=t.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"centered"}},[e._v(e._s(e.$t("Centered")))]),s("option",{attrs:{value:"top-left"}},[e._v(e._s(e.$t("Top Left")))]),s("option",{attrs:{value:"top-center"}},[e._v(e._s(e.$t("Top Center")))]),s("option",{attrs:{value:"top-right"}},[e._v(e._s(e.$t("Top Right")))]),s("option",{attrs:{value:"bottom-left"}},[e._v(e._s(e.$t("Bottom Left")))]),s("option",{attrs:{value:"bottom-center"}},[e._v(e._s(e.$t("Bottom Center")))]),s("option",{attrs:{value:"bottom-right"}},[e._v(e._s(e.$t("Bottom Right")))])])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"url"!==e.type&&"scroll"!==e.type,expression:"type !== 'url' && type !== 'scroll'"}],class:"overlay"===e.type?"col-6":"col-12"},[s("form-field",{attrs:{name:"settingTransition"}},[s("label",{attrs:{for:"hotspot_transition_"+e.hotspot.id}},[e._v(e._s(e.$t("Transition")))]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.transition,expression:"transition"}],attrs:{id:"hotspot_transition_"+e.hotspot.id},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.transition=t.target.multiple?s:s[0]}}},[s("option",{attrs:{value:"none"}},[e._v(e._s(e.$t("None")))]),s("option",{attrs:{value:"fade"}},[e._v(e._s(e.$t("Fade")))]),s("option",{attrs:{value:"slide-left"}},[e._v(e._s(e.$t("Slide left")))]),s("option",{attrs:{value:"slide-right"}},[e._v(e._s(e.$t("Slide right")))]),s("option",{attrs:{value:"slide-top"}},[e._v(e._s(e.$t("Slide top")))]),s("option",{attrs:{value:"slide-bottom"}},[e._v(e._s(e.$t("Slide bottom")))])])])],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"overlay"===e.type,expression:"type === 'overlay'"}],staticClass:"form-group form-group-sm"},[s("label",[e._v(e._s(e.$t("Offset"))+" "),s("small",{staticClass:"txt-hint"},[e._v("(px)")])]),s("div",{staticClass:"input-group"},[s("div",{staticClass:"input-addon bg-light-border"},[e._v("T")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.offsetTop,expression:"offsetTop",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("Top offset"),expression:"$t('Top offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:e.offsetTop},on:{input:function(t){t.target.composing||(e.offsetTop=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon bg-light-border"},[e._v("B")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.offsetBottom,expression:"offsetBottom",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("Bottom offset"),expression:"$t('Bottom offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:e.offsetBottom},on:{input:function(t){t.target.composing||(e.offsetBottom=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon bg-light-border"},[e._v("L")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.offsetLeft,expression:"offsetLeft",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("Left offset"),expression:"$t('Left offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:e.offsetLeft},on:{input:function(t){t.target.composing||(e.offsetLeft=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon bg-light-border"},[e._v("R")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.offsetRight,expression:"offsetRight",modifiers:{number:!0}},{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("Right offset"),expression:"$t('Right offset')",modifiers:{bottom:!0}}],attrs:{type:"number"},domProps:{value:e.offsetRight},on:{input:function(t){t.target.composing||(e.offsetRight=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"scroll"===e.type,expression:"type === 'scroll'"}],staticClass:"row"},[s("div",{staticClass:"col-6"},[s("form-field",{attrs:{name:"settingScrollTop"}},[s("label",{attrs:{for:"hotspot_scroll_top_"+e.hotspot.id}},[e._v(e._s(e.$t("Vertical position")))]),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.scrollTop,expression:"scrollTop",modifiers:{number:!0}}],attrs:{type:"number",id:"hotspot_scroll_top_"+e.hotspot.id,min:"0"},domProps:{value:e.scrollTop},on:{input:function(t){t.target.composing||(e.scrollTop=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[e._v("px")])])])],1),s("div",{staticClass:"col-6"},[s("form-field",{attrs:{name:"settingScrollLeft"}},[s("label",{attrs:{for:"hotspot_scroll_left_"+e.hotspot.id}},[e._v(e._s(e.$t("Horizontal position")))]),s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model.number",value:e.scrollLeft,expression:"scrollLeft",modifiers:{number:!0}}],attrs:{type:"number",id:"hotspot_scroll_left_"+e.hotspot.id,min:"0"},domProps:{value:e.scrollLeft},on:{input:function(t){t.target.composing||(e.scrollLeft=e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}}),s("div",{staticClass:"input-addon"},[e._v("px")])])])],1)]),s("form-field",{directives:[{name:"show",rawName:"v-show",value:"overlay"===e.type,expression:"type === 'overlay'"}],attrs:{name:"settingFixOverlay"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.fixOverlay,expression:"fixOverlay"}],attrs:{type:"checkbox",id:"hotspot_screen_overlay_fix_position"+e.hotspot.id},domProps:{checked:Array.isArray(e.fixOverlay)?e._i(e.fixOverlay,null)>-1:e.fixOverlay},on:{change:function(t){var s=e.fixOverlay,o=t.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);o.checked?n<0&&(e.fixOverlay=s.concat([r])):n>-1&&(e.fixOverlay=s.slice(0,n).concat(s.slice(n+1)))}else e.fixOverlay=i}}}),s("label",{attrs:{for:"hotspot_screen_overlay_fix_position"+e.hotspot.id}},[e._v(e._s(e.$t("Fix position of overlay")))])]),s("form-field",{directives:[{name:"show",rawName:"v-show",value:"overlay"===e.type,expression:"type === 'overlay'"}],attrs:{name:"settingOutsideClose"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.outsideClose,expression:"outsideClose"}],attrs:{type:"checkbox",id:"hotspot_screen_overlay_outside_click_"+e.hotspot.id},domProps:{checked:Array.isArray(e.outsideClose)?e._i(e.outsideClose,null)>-1:e.outsideClose},on:{change:function(t){var s=e.outsideClose,o=t.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);o.checked?n<0&&(e.outsideClose=s.concat([r])):n>-1&&(e.outsideClose=s.slice(0,n).concat(s.slice(n+1)))}else e.outsideClose=i}}}),s("label",{attrs:{for:"hotspot_screen_overlay_outside_click_"+e.hotspot.id}},[e._v(e._s(e.$t("Close on outside click")))])]),e.$getAppConfig("VUE_APP_ALLOW_HOTSPOTS_URL")<<0?s("form-field",{directives:[{name:"show",rawName:"v-show",value:"url"===e.type,expression:"type === 'url'"}],attrs:{name:"settingUrl"}},[s("label",{attrs:{for:"hotspot_external_url_"+e.hotspot.id}},[e._v("URL")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.url,expression:"url"}],attrs:{type:"url",id:"hotspot_external_url_"+e.hotspot.id,placeholder:e.$t("eg.")+" https://google.com"},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value)}}})]):e._e(),s("div",{staticClass:"form-group m-b-10"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.includeInTemplate,expression:"includeInTemplate"}],attrs:{type:"checkbox",id:"hotspot_include_in_template_toggle_"+e.hotspot.id},domProps:{checked:Array.isArray(e.includeInTemplate)?e._i(e.includeInTemplate,null)>-1:e.includeInTemplate},on:{change:function(t){var s=e.includeInTemplate,o=t.target,i=!!o.checked;if(Array.isArray(s)){var r=null,n=e._i(s,r);o.checked?n<0&&(e.includeInTemplate=s.concat([r])):n>-1&&(e.includeInTemplate=s.slice(0,n).concat(s.slice(n+1)))}else e.includeInTemplate=i}}}),s("label",{attrs:{for:"hotspot_include_in_template_toggle_"+e.hotspot.id}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Include in template")))]),s("i",{directives:[{name:"tooltip",rawName:"v-tooltip.right",value:e.$t("Allows reusing the hotspot in other screens"),expression:"$t('Allows reusing the hotspot in other screens')",modifiers:{right:!0}}],staticClass:"fe fe-info link-hint m-l-5"})])]),e.includeInTemplate?s("div",{staticClass:"form-group-section m-b-0"},[s("div",{staticClass:"form-group form-group-sm",class:{"m-b-5":"new"===e.template}},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.template,expression:"template"}],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.template=t.target.multiple?s:s[0]}}},[e._l(e.hotspotTemplates,(function(t){return s("option",{domProps:{value:t.id}},[e._v(" "+e._s(t.title)+" ")])})),s("option",{attrs:{value:"new"}},[e._v("+ "+e._s(e.$t("New template")))])],2)]),"new"===e.template?s("div",{staticClass:"form-group form-group-sm"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.newTemplateTitle,expression:"newTemplateTitle",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:e.$t("Template name")+" *",required:"",minlength:"1",maxlength:"255"},domProps:{value:e.newTemplateTitle},on:{input:function(t){t.target.composing||(e.newTemplateTitle=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]):e._e()]):e._e(),s("hr",{staticClass:"m-t-20 m-b-20"}),s("div",{staticClass:"flex-block"},[s("button",{staticClass:"btn btn-light-border",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.close()}}},[s("span",{staticClass:"txt"},[e._v(e._s(e.$t("Cancel")))])]),e.hotspot.id?s("span",{staticClass:"link-fade txt-danger m-l-small",on:{click:function(t){return t.preventDefault(),e.deleteHotspot()}}},[e._v(" "+e._s(e.$t("Delete"))+" ")]):e._e(),s("div",{staticClass:"flex-fill-block"}),s("button",{staticClass:"btn btn-primary btn-cons-sm btn-loader",class:{"btn-loader-active":e.isProcessing},attrs:{type:"submit"}},[s("span",{staticClass:"txt"},[e._v(e._s(e.hotspot.id?e.$t("Update"):e.$t("Create")))])])])],1)])])},X=[];function Y(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function K(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Y(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var J={name:"hotspot-popover",data(){return{isActive:!1,repositionToElem:null,hotspot:new M["a"],isProcessing:!1,type:"screen",screenId:null,url:"",transition:"none",overlayPosition:"top-left",fixOverlay:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,outsideClose:!0,scrollTop:0,scrollLeft:0,includeInTemplate:!1,template:1,isCreatingHotspotTemplate:!1,newTemplateTitle:""}},computed:K(K(K({},Object(n["d"])({activePrototypeId:e=>e.prototypes.activePrototypeId,activeScreenId:e=>e.screens.activeScreenId,hotspots:e=>e.hotspots.hotspots,hotspotTemplates:e=>e.hotspots.hotspotTemplates})),Object(n["c"])({orderedScreens:"screens/orderedScreens",getScreen:"screens/getScreen",getHotspot:"hotspots/getHotspot",getHotspotTemplate:"hotspots/getHotspotTemplate"})),{},{selectedScreen(){return this.getScreen(this.screenId)}}),watch:{includeInTemplate(e,t){this.$nextTick(()=>{this.reposition()})},type(e,t){this.$nextTick(()=>{this.reposition()})},screenId(e,t){this.removeError("settingScreenId")}},mounted(){document.addEventListener("scroll",this.onEventPopoverReposition,{capture:!0,passive:!0}),window.addEventListener("resize",this.onEventPopoverReposition,{passive:!0})},beforeDestroy(){document.removeEventListener("scroll",this.onEventPopoverReposition,{capture:!0}),window.removeEventListener("resize",this.onEventPopoverReposition)},methods:K(K({},Object(n["b"])({setErrors:"form-field/setErrors",removeError:"form-field/removeError",removeHotspot:"hotspots/removeHotspot",addHotspotTemplate:"hotspots/addHotspotTemplate"})),{},{open(e,t){this.isActive||(this.isActive=!0,e instanceof M["a"]?this.hotspot=e:this.hotspot=new M["a"](e),this.reloadForm(),t&&(this.repositionToElem=t,this.reposition(t)),this.$emit("opened"))},close(){this.isActive&&(this.isActive=!1,this.hotspot.id||this.removeHotspot(this.hotspot.id),this.$emit("closed"))},onEventPopoverReposition(e){this.isActive&&this.reposition()},reposition(e){if(e=e||this.repositionToElem,this.isActive&&e){var t=this.$refs.popover,s=e.getBoundingClientRect(),o=5,i=s.top-o,r=s.left+s.width+o;t.style.left="0px",t.style.top="0px",r+t.offsetWidth>document.documentElement.clientWidth&&(r=s.left-t.offsetWidth-o),r=r>=0?r:0,i+t.offsetHeight>document.documentElement.clientHeight&&(i=document.documentElement.clientHeight-t.offsetHeight),i=i>=0?i:0,t.style.left=r+"px",t.style.top=i+"px"}},selectScreen(e){this.screenId=e,this.$refs.screensDropdown&&this.$refs.screensDropdown.hide()},reloadForm(){this.type=this.hotspot.type,this.screenId=l["a"].getNestedVal(this.hotspot,"settings.screenId",null),this.url=l["a"].getNestedVal(this.hotspot,"settings.url",""),this.transition=l["a"].getNestedVal(this.hotspot,"settings.transition","none"),this.overlayPosition=l["a"].getNestedVal(this.hotspot,"settings.overlayPosition","top-left"),this.fixOverlay=!!l["a"].getNestedVal(this.hotspot,"settings.fixOverlay"),this.offsetTop=l["a"].getNestedVal(this.hotspot,"settings.offsetTop",0)<<0,this.offsetBottom=l["a"].getNestedVal(this.hotspot,"settings.offsetBottom",0)<<0,this.offsetLeft=l["a"].getNestedVal(this.hotspot,"settings.offsetLeft",0)<<0,this.offsetRight=l["a"].getNestedVal(this.hotspot,"settings.offsetRight",0)<<0,this.scrollTop=l["a"].getNestedVal(this.hotspot,"settings.scrollTop",0)<<0,this.scrollLeft=l["a"].getNestedVal(this.hotspot,"settings.scrollLeft",0)<<0,this.outsideClose=!!l["a"].getNestedVal(this.hotspot,"settings.outsideClose",!0),this.includeInTemplate=this.hotspot.hotspotTemplateId>0,this.template=this.hotspot.hotspotTemplateId||(this.hotspotTemplates[0]?this.hotspotTemplates[0].id:"new"),this.newTemplateTitle="",this.setErrors({})},submitForm(){this.isProcessing||(this.isProcessing=!0,this.createHotspotTemplate().finally(()=>{var e=this.hotspot.id>0,t=this.includeInTemplate?this.getHotspotTemplate(this.template):null,s={screenId:t?null:this.activeScreenId,hotspotTemplateId:t?t.id:null,left:this.hotspot.left,top:this.hotspot.top,width:this.hotspot.width,height:this.hotspot.height,type:this.type,settingScreenId:this.screenId,settingUrl:this.url,settingOverlayPosition:this.overlayPosition,settingFixOverlay:this.fixOverlay,settingTransition:this.transition,settingOffsetTop:this.offsetTop<<0,settingOffsetBottom:this.offsetBottom<<0,settingOffsetLeft:this.offsetLeft<<0,settingOffsetRight:this.offsetRight<<0,settingScrollTop:this.scrollTop<<0,settingScrollLeft:this.scrollLeft<<0,settingOutsideClose:this.outsideClose},o=null;o=e?a["a"].Hotspots.update(this.hotspot.id,s):a["a"].Hotspots.create(s),o.then(e=>{this.hotspot.load(e.data),t&&this.linkToHotspotTemplate(t.id,this.activeScreenId),this.reloadForm(),this.close(),this.$emit("hotspotUpdated",this.hotspot)}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isProcessing=!1})}))},onScreensDropdownShow(){this.$nextTick(()=>{var e=this.$el.querySelector(".dropdown-thumbs-list .thumb.active");e&&e.scrollIntoView({block:"nearest"})})},deleteHotspot(){this.hotspot.id&&window.confirm(this.$t("Do you really want to delete the selected hotspot?"))&&(this.close(),this.removeHotspot(this.hotspot.id),this.$toast(this.$t("Successfully deleted hotspot.")),a["a"].Hotspots.delete(this.hotspot.id))},createHotspotTemplate(){return!this.isCreatingHotspotTemplate&&this.newTemplateTitle&&this.includeInTemplate&&"new"===this.template?(this.isCreatingHotspotTemplate=!0,a["a"].HotspotTemplates.create({title:this.newTemplateTitle,prototypeId:this.activePrototypeId},{expand:"screenIds"}).then(e=>{this.addHotspotTemplate(e.data),this.newTemplateTitle="",this.template=this.hotspotTemplates[this.hotspotTemplates.length-1].id}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>(this.isCreatingHotspotTemplate=!1,Promise.resolve()))):Promise.resolve()},linkToHotspotTemplate(e,t){t=t||this.activeScreenId;var s=this.getHotspotTemplate(e);s&&!l["a"].inArray(s.screenIds,t)&&(s.screenIds.push(t),a["a"].HotspotTemplates.linkScreen(s.id,t))}})},G=J,Q=Object(w["a"])(G,V,X,!1,null,null,null),Z=Q.exports,ee=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("toggler",{staticClass:"popover hotspot-templates-popover",attrs:{hideOnChildClick:!1}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.hotspotTemplates.length,expression:"hotspotTemplates.length"}],staticClass:"hotspot-templates-list"},[e._l(e.hotspotTemplates,(function(t,o){return[s("div",{staticClass:"form-group form-group-switch m-0 flex-block flex-nowrap"},[s("input",{attrs:{type:"checkbox",id:"link_hotspot_template_"+t.id},domProps:{value:t.id,checked:e.isHotspotTemplateLinked(t.id)},on:{change:function(s){return s.preventDefault(),e.toggleLinking(t.id)}}}),s("label",{attrs:{for:"link_hotspot_template_"+t.id}},[e._v("Â ")]),s("div",{ref:"titleElem"+t.id,refInFor:!0,staticClass:"m-r-5",attrs:{contenteditable:"true",spellcheck:"false",autocomplete:"off",title:e.$t("Click to edit"),"data-placeholder":t.title},on:{blur:function(s){return e.updateHotspotTemplateTitle(t.id)},keydown:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:(s.preventDefault(),e.updateHotspotTemplateTitle(t.id))}}},[e._v(e._s(t.title))]),s("small",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Total hotspots"),expression:"$t('Total hotspots')",modifiers:{top:!0}}],staticClass:"label label-light-border align-self-start"},[s("span",{staticClass:"txt txt-hint"},[e._v(e._s(e.countTemplateHotspots(t.id)))])]),s("div",{staticClass:"flex-fill-block"}),s("div",{staticClass:"list-ctrls align-self-start"},[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("Delete"),expression:"$t('Delete')",modifiers:{top:!0}}],staticClass:"list-ctrl-item ctrl-danger",on:{click:function(s){return s.preventDefault(),e.deleteHotspotTemplate(t.id)}}},[s("i",{staticClass:"fe fe-trash"})])])]),s("hr",{staticClass:"m-t-10",class:{"m-b-10":o+1!=e.hotspotTemplates.length}})]}))],2),s("button",{staticClass:"btn btn-sm btn-transp-success btn-block btn-loader",class:{"btn-loader-active":e.isCreating},attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.createHotspotTemplate()}}},[s("i",{staticClass:"fe fe-plus"}),s("span",{staticClass:"txt"},[e._v(e._s(e.$t("New hotspot template")))])])])},te=[];function se(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function oe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?se(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):se(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var ie={name:"hotspot-templates-popover",props:{screen:{type:m["a"],default(){return this.activeScreen}}},data(){return{isCreating:!1}},computed:oe(oe(oe({},Object(n["d"])({hotspots:e=>e.hotspots.hotspots,hotspotTemplates:e=>e.hotspots.hotspotTemplates})),Object(n["c"])({activeScreen:"screens/activeScreen",getHotspotTemplate:"hotspots/getHotspotTemplate"})),{},{linkedHotspotTemplateIds(){var e=[];for(let t in this.hotspotTemplates)l["a"].inArray(this.hotspotTemplates[t].screenIds,this.screen.id)&&e.push(this.hotspotTemplates[t].id);return e}}),methods:oe(oe({},Object(n["b"])({removeHotspotTemplate:"hotspots/removeHotspotTemplate",updateHotspotTemplate:"hotspots/updateHotspotTemplate",addHotspotTemplate:"hotspots/addHotspotTemplate"})),{},{countTemplateHotspots(e){var t=0;for(let s=this.hotspots.length-1;s>=0;s--)this.hotspots[s].hotspotTemplateId==e&&t++;return t},deleteHotspotTemplate(e){var t=this.getHotspotTemplate(e);t&&window.confirm(this.$t('Do you really want to delete template "{title}" and all its hotspots?',{title:t.title}))&&(this.$toast(this.$t('Successfully deleted template "{title}".',{title:t.title})),this.removeHotspotTemplate(t.id),a["a"].HotspotTemplates.delete(t.id))},updateHotspotTemplateTitle(e){var t=this.getHotspotTemplate(e),s=this.$refs["titleElem"+e]?this.$refs["titleElem"+e][0]:null;t&&s&&s.innerText!==t.title&&(s.innerText.trim()?(s.blur(),a["a"].HotspotTemplates.update(t.id,{title:s.innerText},{expand:"screenIds"}).then(e=>{this.updateHotspotTemplate(e.data),t=this.getHotspotTemplate(t.id),s.innerText=t.title}).catch(e=>{this.$errResponseHandler(e)})):s.innerText=t.title)},createHotspotTemplate(e){this.isCreating||(e=e||this.$t("Template")+" "+(this.hotspotTemplates.length+1),this.isCreating=!0,a["a"].HotspotTemplates.create({title:e,prototypeId:this.screen.prototypeId},{expand:"screenIds"}).then(e=>{this.addHotspotTemplate(e.data),this.$toast(this.$t("Successfully created new hotspot template."))}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isCreating=!1}))},isHotspotTemplateLinked(e){return l["a"].inArray(this.linkedHotspotTemplateIds,e)},toggleLinking(e){this.isHotspotTemplateLinked(e)?this.unlinkFromHotspotTemplate(e):this.linkToHotspotTemplate(e)},linkToHotspotTemplate(e){var t=this.screen.id,s=this.getHotspotTemplate(e);s&&!l["a"].inArray(s.screenIds,t)&&(s.screenIds.push(t),a["a"].HotspotTemplates.linkScreen(s.id,t))},unlinkFromHotspotTemplate(e){var t=this.screen.id,s=this.getHotspotTemplate(e);s&&l["a"].inArray(s.screenIds,t)&&(s.screenIds.splice(s.screenIds.indexOf(t<<0),1),a["a"].HotspotTemplates.unlinkScreen(s.id,t))}})},re=ie,ne=(s("9d2a"),Object(w["a"])(re,ee,te,!1,null,"70368ede",null)),ae=ne.exports,le=s("7bbf"),ce=s("917d"),pe=s("57d1"),de=s("c647"),he=s("35bb");function me(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function ue(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?me(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):me(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var ve={computed:ue(ue(ue({},Object(n["d"])({activeScreenId:e=>e.screens.activeScreenId,hotspots:e=>e.hotspots.hotspots,hotspotTemplates:e=>e.hotspots.hotspotTemplates})),Object(n["c"])({getHotspotsForScreen:"hotspots/getHotspotsForScreen"})),{},{activeScreenHotspots(){return this.getHotspotsForScreen(this.activeScreenId)},totalActiveHotspotTemplates(){var e=0;for(let t in this.hotspotTemplates)l["a"].inArray(this.hotspotTemplates[t].screenIds,this.activeScreenId)&&e++;return e}}),methods:ue(ue({},Object(n["b"])({addHotspot:"hotspots/addHotspot"})),{},{initHotspotCreation(e,t){if(this.isInHotspotsMode){t=t||this.activeScreenId;var s=new M["a"]({screenId:t,left:e.offsetX/this.scaleFactor,top:e.offsetY/this.scaleFactor});this.addHotspot(s),this.$nextTick(()=>{if(this.$refs.hotspotBoxes){var t=this.$refs.hotspotBoxes[this.$refs.hotspotBoxes.length-1];t&&(t.activate(),t.initResizing(e))}})}},viewHotspot(e){if(this.$refs.hotspotBoxes)for(let t in this.$refs.hotspotBoxes){let s=this.$refs.hotspotBoxes[t];if(s.hotspot&&s.hotspot.id==e){s.activate();break}}},deactivateHotspots(){if(this.$refs.hotspotPopover&&this.$refs.hotspotPopover.close(),this.$refs.hotspotBoxes)for(let e in this.$refs.hotspotBoxes)this.$refs.hotspotBoxes[e].deactivate()},onHotspotPopoverClose(){this.deactivateHotspots()},onHotspotActivate(e,t){this.deactivateHotspots(),this.$refs.hotspotPopover&&this.$refs.hotspotPopover.open(e,t)},onHotspotRepositioning(e,t){this.$nextTick(()=>{this.$refs.hotspotPopover&&this.$refs.hotspotPopover.reposition(t)})},getActiveHotspotBox(){if(this.$refs.hotspotBoxes)for(let e in this.$refs.hotspotBoxes)if(this.$refs.hotspotBoxes[e].isActive)return this.$refs.hotspotBoxes[e];return null},snapActiveHotspot(e){if(this.isInHotspotsMode){var t=this.getActiveHotspotBox();t&&t.snap()}}})};function fe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,o)}return s}function ge(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(s),!0).forEach((function(t){Object(r["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):fe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const ye="preview",be="hotspots",_e="comments";var we={name:"screens-view",mixins:[de["a"],he["a"],ve,u["a"]],components:{"screen-preview":c["a"],"screens-panel":p["a"],"screen-edit-popover":H,"comment-pin":le["a"],"active-comment-popover":ce["a"],"comments-panel":pe["a"],"hotspot-box":q,"hotspot-popover":Z,"hotspot-templates-popover":ae},data(){return{mode:ye,isLoadingScreens:!1,isResponsiveShowMoreActive:!1,isReplaceHandleClickable:!1}},computed:ge(ge(ge({},Object(n["d"])({loggedUser:e=>e.user.user,activePrototypeId:e=>e.prototypes.activePrototypeId,screens:e=>e.screens.screens,activeScreenId:e=>e.screens.activeScreenId})),Object(n["c"])({activePrototype:"prototypes/activePrototype",getScreen:"screens/getScreen",activeScreen:"screens/activeScreen",activeScreenOrderedIndex:"screens/activeScreenOrderedIndex"})),{},{isInCommentsMode(){return this.mode===_e},isInHotspotsMode(){return this.mode===be},isInPreviewMode(){return this.mode===ye},modeHelpTooltip(){return this.isInCommentsMode?this.$t("Click to leave a comment"):this.isInHotspotsMode?this.$t('Click and drag to create a hotspot\n(hold "{shortcut}" to snap)',{shortcut:"Ctrl"}):""}}),watch:{mode(e,t){!this.isInCommentsMode&&this.$refs.commentsPanel&&this.$refs.commentsPanel.hide(),this.updateRouteMode()},activeScreenId(e,t){this.deactivateHotspots(),this.deactivateComments(),this.updateRouteScreenId(),setTimeout(()=>{this.initReplace(this.activeScreen,this.$refs.previewContainer)},0)},"$route.params.screenId":function(e,t){e&&this.getScreen(e)?e!=this.activeScreenId&&this.setActiveScreenId(e):this.updateRouteScreenId()},"$route.query.mode":function(e,t){e===_e?this.setCommentsMode():e===ye?this.setPreviewMode():e===be?this.setHotspotsMode():this.updateRouteMode()}},beforeMount(){this.$route.query.mode===_e||this.$route.query.commentId?this.setCommentsMode():this.$route.query.mode===be?this.setHotspotsMode():this.setPreviewMode(),this.init()},mounted(){this.initReplace(this.activeScreen,this.$refs.previewContainer)},methods:ge(ge({},Object(n["b"])({setScreens:"screens/setScreens",setActiveScreenId:"screens/setActiveScreenId",addPrototype:"prototypes/addPrototype",setActivePrototypeId:"prototypes/setActivePrototypeId"})),{},{responsiveShowMore(){this.isResponsiveShowMoreActive=!0},responsiveHideMore(){this.isResponsiveShowMoreActive=!1},init(){this.$setDocumentTitle(()=>this.$t("Screen")),this.loadScreens(this.$route.params.prototypeId,this.$route.params.screenId),this.loadHotspots(this.$route.params.prototypeId),this.loadHotspotTemplates(this.$route.params.prototypeId),this.loadComments(this.$route.params.prototypeId),this.loadMentionsList(this.$route.params.projectId)},loadMentionsList(e){e=e||(this.activePrototype?this.activePrototype.projectId:null),e&&a["a"].Projects.getCollaboratorsList(e).then(e=>{this.mentionsList=this.convertCollaboratorsListToMentionsList(e.data,[this.loggedUser.email])})},loadScreens(e,t){e=e||this.activePrototypeId,e&&!this.isLoadingScreens&&(this.isLoadingScreens=!0,a["a"].Prototypes.getOne(e,{expand:"screens"}).then(e=>{this.addPrototype(e.data),this.setActivePrototypeId(l["a"].getNestedVal(e,"data.id")),this.setScreens(l["a"].getNestedVal(e,"data.screens",[])),this.getScreen(t)&&this.setActiveScreenId(t),this.updateRouteProjectId(),this.updateRouteScreenId(),this.updateRouteMode(),this.initReplace(this.activeScreen,this.$refs.previewContainer)}).catch(e=>{this.$errResponseHandler(e)}).finally(()=>{this.isLoadingScreens=!1}))},updateRouteProjectId(){this.activePrototype&&this.$route.params.projectId!=this.activePrototype.projectId&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params,{projectId:this.activePrototype.projectId}),query:Object.assign({},this.$route.query)})},updateRouteScreenId(){let e=this.$route.params.screenId;e!=this.activeScreenId&&this.$router[e?"push":"replace"]({name:this.$route.name,params:Object.assign({},this.$route.params,{screenId:this.activeScreenId}),query:Object.assign({},this.$route.query)})},updateRouteMode(){this.$route.query.mode!=this.mode&&this.$router.replace({name:this.$route.name,params:Object.assign({},this.$route.params),query:Object.assign({},this.$route.query,{mode:this.mode})})},setCommentsMode(){this.mode=_e},setHotspotsMode(){this.mode=be},setPreviewMode(){this.mode=ye},onEscPress(e){this.isInHotspotsMode?(e.preventDefault(),this.deactivateHotspots()):this.isInCommentsMode&&(e.preventDefault(),this.deactivateComments())},onActiveScreenMousedown(e){this.isInHotspotsMode&&this.initHotspotCreation(e,this.activeScreenId)},onActiveScreenClick(e){this.isInPreviewMode?this.blinkPreviewModeHints():this.isInCommentsMode&&this.initCommentCreation(e,this.activeScreenId)}})},Ce=we,$e=Object(w["a"])(Ce,o,i,!1,null,null,null);t["default"]=$e.exports}}]);